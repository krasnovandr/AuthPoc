2018-07-27 14:24:10.267 +03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-07-27 14:24:10.312 +03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-07-27 14:24:10.318 +03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-07-27 14:24:10.322 +03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-07-27 14:24:10.325 +03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-07-27 14:24:10.642 +03:00 [DBG] Starting token cleanup
2018-07-27 16:25:13.088 +03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-07-27 16:25:13.149 +03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-07-27 16:25:13.155 +03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-07-27 16:25:13.160 +03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-07-27 16:25:13.165 +03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-07-27 16:25:13.531 +03:00 [DBG] Starting token cleanup
2018-07-27 16:25:15.087 +03:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2018-07-27 16:25:15.131 +03:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2018-07-27 16:25:38.823 +03:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2018-07-27 16:25:38.827 +03:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2018-07-27 16:25:38.835 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-07-27 16:25:38.864 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-07-27 16:25:38.867 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-07-27 16:25:38.872 +03:00 [DBG] Start discovery request
2018-07-27 16:25:39.955 +03:00 [DBG] Found ["openid","profile","api1"] as all scopes in database
2018-07-27 16:26:35.222 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-07-27 16:26:35.227 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-07-27 16:26:35.230 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-07-27 16:26:35.236 +03:00 [DBG] Start discovery request
2018-07-27 16:26:35.273 +03:00 [DBG] Found ["openid","profile","api1"] as all scopes in database
2018-07-27 16:26:35.496 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-07-27 16:26:35.501 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-07-27 16:26:35.503 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-07-27 16:26:35.511 +03:00 [DBG] Start key discovery request
2018-07-27 16:26:35.642 +03:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2018-07-27 16:26:35.662 +03:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2018-07-27 16:26:35.670 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-07-27 16:26:35.681 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-07-27 16:26:35.684 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-07-27 16:26:35.693 +03:00 [DBG] Start authorize request
2018-07-27 16:26:35.706 +03:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2018-07-27 16:26:35.716 +03:00 [DBG] No user present in authorize request
2018-07-27 16:26:35.724 +03:00 [DBG] Start authorize request protocol validation
2018-07-27 16:26:36.156 +03:00 [DBG] mvc found in database: true
2018-07-27 16:26:36.166 +03:00 [DBG] Checking for PKCE parameters
2018-07-27 16:26:36.169 +03:00 [DBG] No PKCE used.
2018-07-27 16:26:36.218 +03:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-07-27 16:26:36.350 +03:00 [DBG] Found ["api1"] API scopes in database
2018-07-27 16:26:36.371 +03:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-07-27 16:26:36.387 +03:00 [DBG] Found ["api1"] API scopes in database
2018-07-27 16:26:36.400 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-07-27 16:26:36.417 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1 offline_access",
  "State": "CfDJ8KuqC1l7QeZCrHnUtlrKrzJg9__Q7J8_dd-PnAI1gvom4WqGGx-pzEXbEb3RD7-TICs3iWf_4oJO4RhGdO6JCSsl3j84xvko2zs53LUt8s7_McpJJSui5UF0FOUHlmYGtbI8aVudDuJdJMJ5oGIdQp0I0eeKL_cs3_69xM6OAn_OX4icuvjX8HkujQXPY3cHTgIx5b8p7vFyI2FirwvVMtyjZuvTTKE3VNpi5pF1pv32JlXb0C_wamlLPjE0H4QaXE21M945Q5RAEq7dCADIva1v1G-Isegg9eiN_JMJxf6Z2OTD58bOar7NfjoM4qJAt9U8XShOUUn_nGcoLC3AKYQ",
  "Nonce": "636682947955907681.NjUzYWRjN2YtNmJkZi00MzczLWE5ODAtZTM2MzI4MWU5NzExM2RlNzVhN2UtNjgyZS00NDNjLWFjNTQtZGQ1MDU5N2FiYTE3",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636682947955907681.NjUzYWRjN2YtNmJkZi00MzczLWE5ODAtZTM2MzI4MWU5NzExM2RlNzVhN2UtNjgyZS00NDNjLWFjNTQtZGQ1MDU5N2FiYTE3",
    "state": "CfDJ8KuqC1l7QeZCrHnUtlrKrzJg9__Q7J8_dd-PnAI1gvom4WqGGx-pzEXbEb3RD7-TICs3iWf_4oJO4RhGdO6JCSsl3j84xvko2zs53LUt8s7_McpJJSui5UF0FOUHlmYGtbI8aVudDuJdJMJ5oGIdQp0I0eeKL_cs3_69xM6OAn_OX4icuvjX8HkujQXPY3cHTgIx5b8p7vFyI2FirwvVMtyjZuvTTKE3VNpi5pF1pv32JlXb0C_wamlLPjE0H4QaXE21M945Q5RAEq7dCADIva1v1G-Isegg9eiN_JMJxf6Z2OTD58bOar7NfjoM4qJAt9U8XShOUUn_nGcoLC3AKYQ",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-07-27 16:26:36.434 +03:00 [INF] Showing login: User is not authenticated
2018-07-27 16:26:36.457 +03:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2018-07-27 16:26:36.464 +03:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2018-07-27 16:26:36.553 +03:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2018-07-27 16:26:36.557 +03:00 [DBG] Start authorize request protocol validation
2018-07-27 16:26:36.583 +03:00 [DBG] mvc found in database: true
2018-07-27 16:26:36.586 +03:00 [DBG] Checking for PKCE parameters
2018-07-27 16:26:36.588 +03:00 [DBG] No PKCE used.
2018-07-27 16:26:36.595 +03:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-07-27 16:26:36.613 +03:00 [DBG] Found ["api1"] API scopes in database
2018-07-27 16:26:36.620 +03:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-07-27 16:26:36.636 +03:00 [DBG] Found ["api1"] API scopes in database
2018-07-27 16:26:36.641 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-07-27 16:26:36.671 +03:00 [DBG] mvc found in database: true
2018-07-27 16:27:26.639 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-07-27 16:27:26.648 +03:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2018-07-27 16:27:26.652 +03:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2018-07-27 16:27:30.217 +03:00 [DBG] Augmenting SignInContext
2018-07-27 16:27:30.221 +03:00 [DBG] Adding idp claim with value: local
2018-07-27 16:27:30.224 +03:00 [DBG] Adding amr claim with value: pwd
2018-07-27 16:27:30.229 +03:00 [DBG] Adding auth_time claim with value: 1532698050
2018-07-27 16:27:30.233 +03:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2018-07-27 16:27:30.247 +03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-07-27 16:27:30.312 +03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "alice",
  "SubjectId": "906123a3-4bab-49ae-a2c3-c0617fb03398",
  "DisplayName": "alice",
  "Endpoint": "UI",
  "ActivityId": "0HLFJOHHB3L5E:00000005",
  "TimeStamp": "2018-07-27T13:27:30Z",
  "ProcessId": 37968,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-07-27 16:27:30.337 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-07-27 16:27:30.343 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-07-27 16:27:30.347 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-07-27 16:27:30.352 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-07-27 16:27:30.355 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-07-27 16:27:30.371 +03:00 [DBG] Start authorize callback request
2018-07-27 16:27:30.384 +03:00 [DBG] User in authorize request: 906123a3-4bab-49ae-a2c3-c0617fb03398
2018-07-27 16:27:30.387 +03:00 [DBG] Start authorize request protocol validation
2018-07-27 16:27:30.447 +03:00 [DBG] mvc found in database: true
2018-07-27 16:27:30.449 +03:00 [DBG] Checking for PKCE parameters
2018-07-27 16:27:30.452 +03:00 [DBG] No PKCE used.
2018-07-27 16:27:30.464 +03:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-07-27 16:27:30.543 +03:00 [DBG] Found ["api1"] API scopes in database
2018-07-27 16:27:30.557 +03:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-07-27 16:27:30.651 +03:00 [DBG] Found ["api1"] API scopes in database
2018-07-27 16:27:30.657 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-07-27 16:27:30.660 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "906123a3-4bab-49ae-a2c3-c0617fb03398",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1 offline_access",
  "State": "CfDJ8KuqC1l7QeZCrHnUtlrKrzJg9__Q7J8_dd-PnAI1gvom4WqGGx-pzEXbEb3RD7-TICs3iWf_4oJO4RhGdO6JCSsl3j84xvko2zs53LUt8s7_McpJJSui5UF0FOUHlmYGtbI8aVudDuJdJMJ5oGIdQp0I0eeKL_cs3_69xM6OAn_OX4icuvjX8HkujQXPY3cHTgIx5b8p7vFyI2FirwvVMtyjZuvTTKE3VNpi5pF1pv32JlXb0C_wamlLPjE0H4QaXE21M945Q5RAEq7dCADIva1v1G-Isegg9eiN_JMJxf6Z2OTD58bOar7NfjoM4qJAt9U8XShOUUn_nGcoLC3AKYQ",
  "Nonce": "636682947955907681.NjUzYWRjN2YtNmJkZi00MzczLWE5ODAtZTM2MzI4MWU5NzExM2RlNzVhN2UtNjgyZS00NDNjLWFjNTQtZGQ1MDU5N2FiYTE3",
  "SessionId": "ae318ad7ec95807cc0e9a5f3408b08ad",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636682947955907681.NjUzYWRjN2YtNmJkZi00MzczLWE5ODAtZTM2MzI4MWU5NzExM2RlNzVhN2UtNjgyZS00NDNjLWFjNTQtZGQ1MDU5N2FiYTE3",
    "state": "CfDJ8KuqC1l7QeZCrHnUtlrKrzJg9__Q7J8_dd-PnAI1gvom4WqGGx-pzEXbEb3RD7-TICs3iWf_4oJO4RhGdO6JCSsl3j84xvko2zs53LUt8s7_McpJJSui5UF0FOUHlmYGtbI8aVudDuJdJMJ5oGIdQp0I0eeKL_cs3_69xM6OAn_OX4icuvjX8HkujQXPY3cHTgIx5b8p7vFyI2FirwvVMtyjZuvTTKE3VNpi5pF1pv32JlXb0C_wamlLPjE0H4QaXE21M945Q5RAEq7dCADIva1v1G-Isegg9eiN_JMJxf6Z2OTD58bOar7NfjoM4qJAt9U8XShOUUn_nGcoLC3AKYQ",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-07-27 16:27:30.704 +03:00 [DBG] Scopes contains offline_access, consent is required
2018-07-27 16:27:30.707 +03:00 [INF] Showing consent: User has not yet consented
2018-07-27 16:27:30.734 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-07-27 16:27:30.763 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-07-27 16:27:30.800 +03:00 [DBG] Start authorize request protocol validation
2018-07-27 16:27:30.865 +03:00 [DBG] mvc found in database: true
2018-07-27 16:27:30.870 +03:00 [DBG] Checking for PKCE parameters
2018-07-27 16:27:30.873 +03:00 [DBG] No PKCE used.
2018-07-27 16:27:30.887 +03:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-07-27 16:27:31.000 +03:00 [DBG] Found ["api1"] API scopes in database
2018-07-27 16:27:31.065 +03:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-07-27 16:27:31.167 +03:00 [DBG] Found ["api1"] API scopes in database
2018-07-27 16:27:31.172 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-07-27 16:27:31.245 +03:00 [DBG] mvc found in database: true
2018-07-27 16:27:31.258 +03:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-07-27 16:27:31.345 +03:00 [DBG] Found ["api1"] API scopes in database
2018-07-27 16:27:41.038 +03:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-07-27 16:27:41.053 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-07-27 16:27:41.056 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-07-27 16:27:41.114 +03:00 [DBG] Start authorize request protocol validation
2018-07-27 16:27:41.171 +03:00 [DBG] mvc found in database: true
2018-07-27 16:27:41.174 +03:00 [DBG] Checking for PKCE parameters
2018-07-27 16:27:41.177 +03:00 [DBG] No PKCE used.
2018-07-27 16:27:41.191 +03:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-07-27 16:27:41.265 +03:00 [DBG] Found ["api1"] API scopes in database
2018-07-27 16:27:41.274 +03:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-07-27 16:27:41.291 +03:00 [DBG] Found ["api1"] API scopes in database
2018-07-27 16:27:41.293 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-07-27 16:27:41.326 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-07-27 16:27:41.332 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-07-27 16:27:41.336 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-07-27 16:27:41.341 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-07-27 16:27:41.343 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-07-27 16:27:41.353 +03:00 [DBG] Start authorize callback request
2018-07-27 16:27:41.393 +03:00 [DBG] User in authorize request: 906123a3-4bab-49ae-a2c3-c0617fb03398
2018-07-27 16:27:41.401 +03:00 [DBG] Start authorize request protocol validation
2018-07-27 16:27:41.432 +03:00 [DBG] mvc found in database: true
2018-07-27 16:27:41.434 +03:00 [DBG] Checking for PKCE parameters
2018-07-27 16:27:41.436 +03:00 [DBG] No PKCE used.
2018-07-27 16:27:41.446 +03:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-07-27 16:27:41.464 +03:00 [DBG] Found ["api1"] API scopes in database
2018-07-27 16:27:41.473 +03:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-07-27 16:27:41.496 +03:00 [DBG] Found ["api1"] API scopes in database
2018-07-27 16:27:41.503 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-07-27 16:27:41.508 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "906123a3-4bab-49ae-a2c3-c0617fb03398",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1 offline_access",
  "State": "CfDJ8KuqC1l7QeZCrHnUtlrKrzJg9__Q7J8_dd-PnAI1gvom4WqGGx-pzEXbEb3RD7-TICs3iWf_4oJO4RhGdO6JCSsl3j84xvko2zs53LUt8s7_McpJJSui5UF0FOUHlmYGtbI8aVudDuJdJMJ5oGIdQp0I0eeKL_cs3_69xM6OAn_OX4icuvjX8HkujQXPY3cHTgIx5b8p7vFyI2FirwvVMtyjZuvTTKE3VNpi5pF1pv32JlXb0C_wamlLPjE0H4QaXE21M945Q5RAEq7dCADIva1v1G-Isegg9eiN_JMJxf6Z2OTD58bOar7NfjoM4qJAt9U8XShOUUn_nGcoLC3AKYQ",
  "Nonce": "636682947955907681.NjUzYWRjN2YtNmJkZi00MzczLWE5ODAtZTM2MzI4MWU5NzExM2RlNzVhN2UtNjgyZS00NDNjLWFjNTQtZGQ1MDU5N2FiYTE3",
  "SessionId": "ae318ad7ec95807cc0e9a5f3408b08ad",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636682947955907681.NjUzYWRjN2YtNmJkZi00MzczLWE5ODAtZTM2MzI4MWU5NzExM2RlNzVhN2UtNjgyZS00NDNjLWFjNTQtZGQ1MDU5N2FiYTE3",
    "state": "CfDJ8KuqC1l7QeZCrHnUtlrKrzJg9__Q7J8_dd-PnAI1gvom4WqGGx-pzEXbEb3RD7-TICs3iWf_4oJO4RhGdO6JCSsl3j84xvko2zs53LUt8s7_McpJJSui5UF0FOUHlmYGtbI8aVudDuJdJMJ5oGIdQp0I0eeKL_cs3_69xM6OAn_OX4icuvjX8HkujQXPY3cHTgIx5b8p7vFyI2FirwvVMtyjZuvTTKE3VNpi5pF1pv32JlXb0C_wamlLPjE0H4QaXE21M945Q5RAEq7dCADIva1v1G-Isegg9eiN_JMJxf6Z2OTD58bOar7NfjoM4qJAt9U8XShOUUn_nGcoLC3AKYQ",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-07-27 16:27:41.531 +03:00 [DBG] Scopes contains offline_access, consent is required
2018-07-27 16:27:41.540 +03:00 [INF] User consented to scopes: ["openid","profile","api1","offline_access"]
2018-07-27 16:27:41.544 +03:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","api1","offline_access"]
2018-07-27 16:27:41.552 +03:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 906123a3-4bab-49ae-a2c3-c0617fb03398
2018-07-27 16:27:41.595 +03:00 [DBG] BVr/wCR88mcAGKjUQ2Y7vAVVgMPNxP8zr6xg2B1d4Us= found in database
2018-07-27 16:27:41.655 +03:00 [DBG] Creating Hybrid Flow response.
2018-07-27 16:27:41.684 +03:00 [DBG] FGrFJTf5fZ3XdIe0zlWN0zl+ndpGXHwySyRJsMhQwK8= not found in database
2018-07-27 16:27:41.706 +03:00 [DBG] Creating Implicit Flow response.
2018-07-27 16:27:41.723 +03:00 [DBG] Getting claims for identity token for subject: 906123a3-4bab-49ae-a2c3-c0617fb03398 and client: mvc
2018-07-27 16:27:41.732 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-07-27 16:27:41.829 +03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "Endpoint": "Authorize",
  "SubjectId": "906123a3-4bab-49ae-a2c3-c0617fb03398",
  "Scopes": "openid profile api1 offline_access",
  "GrantType": "hybrid",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****KbYg"
    },
    {
      "TokenType": "code",
      "TokenValue": "****ad41"
    }
  ],
  "ActivityId": "0HLFJOHHB3L5E:0000000A",
  "TimeStamp": "2018-07-27T13:27:41Z",
  "ProcessId": 37968,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-07-27 16:27:41.839 +03:00 [INF] Authorize endpoint response
{
  "SubjectId": "906123a3-4bab-49ae-a2c3-c0617fb03398",
  "ClientId": "mvc",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "State": "CfDJ8KuqC1l7QeZCrHnUtlrKrzJg9__Q7J8_dd-PnAI1gvom4WqGGx-pzEXbEb3RD7-TICs3iWf_4oJO4RhGdO6JCSsl3j84xvko2zs53LUt8s7_McpJJSui5UF0FOUHlmYGtbI8aVudDuJdJMJ5oGIdQp0I0eeKL_cs3_69xM6OAn_OX4icuvjX8HkujQXPY3cHTgIx5b8p7vFyI2FirwvVMtyjZuvTTKE3VNpi5pF1pv32JlXb0C_wamlLPjE0H4QaXE21M945Q5RAEq7dCADIva1v1G-Isegg9eiN_JMJxf6Z2OTD58bOar7NfjoM4qJAt9U8XShOUUn_nGcoLC3AKYQ",
  "Scope": "openid profile api1 offline_access"
}
2018-07-27 16:27:41.868 +03:00 [DBG] Augmenting SignInContext
2018-07-27 16:27:41.870 +03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-07-27 16:27:42.112 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2018-07-27 16:27:42.123 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2018-07-27 16:27:42.127 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2018-07-27 16:27:42.141 +03:00 [DBG] Start token request.
2018-07-27 16:27:42.165 +03:00 [DBG] Start client validation
2018-07-27 16:27:42.172 +03:00 [DBG] Start parsing Basic Authentication secret
2018-07-27 16:27:42.182 +03:00 [DBG] Start parsing for secret in post body
2018-07-27 16:27:42.184 +03:00 [DBG] Parser found secret: PostBodySecretParser
2018-07-27 16:27:42.188 +03:00 [DBG] Secret id found: mvc
2018-07-27 16:27:42.218 +03:00 [DBG] mvc found in database: true
2018-07-27 16:27:42.230 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2018-07-27 16:27:42.232 +03:00 [DBG] Client validation success
2018-07-27 16:27:42.239 +03:00 [INF] {
  "Name": "Client Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1010,
  "ClientId": "mvc",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HLFJOHHB3L5N:00000001",
  "TimeStamp": "2018-07-27T13:27:42Z",
  "ProcessId": 37968,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-07-27 16:27:42.249 +03:00 [DBG] Start token request validation
2018-07-27 16:27:42.260 +03:00 [DBG] Start validation of authorization code token request
2018-07-27 16:27:42.288 +03:00 [DBG] FGrFJTf5fZ3XdIe0zlWN0zl+ndpGXHwySyRJsMhQwK8= found in database: true
2018-07-27 16:27:42.324 +03:00 [DBG] removing FGrFJTf5fZ3XdIe0zlWN0zl+ndpGXHwySyRJsMhQwK8= persisted grant from database
2018-07-27 16:27:42.342 +03:00 [DBG] Validation of authorization code token request success
2018-07-27 16:27:42.352 +03:00 [INF] Token request validation success
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "GrantType": "authorization_code",
  "AuthorizationCode": "e18df89042da74f604acef0b259a229dd27daf18115c66d0a4ca36e25cb3ad41",
  "Raw": {
    "client_id": "mvc",
    "client_secret": "***REDACTED***",
    "code": "e18df89042da74f604acef0b259a229dd27daf18115c66d0a4ca36e25cb3ad41",
    "grant_type": "authorization_code",
    "redirect_uri": "http://localhost:5002/signin-oidc"
  }
}
2018-07-27 16:27:42.395 +03:00 [DBG] mvc found in database: true
2018-07-27 16:27:42.408 +03:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-07-27 16:27:42.490 +03:00 [DBG] Found ["api1"] API scopes in database
2018-07-27 16:27:42.505 +03:00 [DBG] Getting claims for access token for client: mvc
2018-07-27 16:27:42.507 +03:00 [DBG] Getting claims for access token for subject: 906123a3-4bab-49ae-a2c3-c0617fb03398
2018-07-27 16:27:42.535 +03:00 [DBG] Creating refresh token
2018-07-27 16:27:42.537 +03:00 [DBG] Setting an absolute lifetime: 2592000
2018-07-27 16:27:42.560 +03:00 [DBG] rYf9Jmf6/fXek1b0XJTqhqsZAiSOehaW5lqb8dvTVDQ= not found in database
2018-07-27 16:27:42.593 +03:00 [DBG] mvc found in database: true
2018-07-27 16:27:42.605 +03:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-07-27 16:27:42.622 +03:00 [DBG] Found ["api1"] API scopes in database
2018-07-27 16:27:42.625 +03:00 [DBG] Getting claims for identity token for subject: 906123a3-4bab-49ae-a2c3-c0617fb03398 and client: mvc
2018-07-27 16:27:42.628 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-07-27 16:27:42.637 +03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "Endpoint": "Token",
  "Scopes": "openid profile api1 offline_access",
  "GrantType": "authorization_code",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****bpmA"
    },
    {
      "TokenType": "refresh_token",
      "TokenValue": "****dd49"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****MwdA"
    }
  ],
  "ActivityId": "0HLFJOHHB3L5N:00000001",
  "TimeStamp": "2018-07-27T13:27:42Z",
  "ProcessId": 37968,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-07-27 16:27:42.643 +03:00 [DBG] Token request success.
2018-07-27 16:27:42.669 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2018-07-27 16:27:42.674 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2018-07-27 16:27:42.676 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2018-07-27 16:27:42.687 +03:00 [DBG] Start userinfo request
2018-07-27 16:27:42.693 +03:00 [DBG] Bearer token found in header
2018-07-27 16:27:42.779 +03:00 [DBG] mvc found in database: true
2018-07-27 16:27:42.820 +03:00 [DBG] mvc found in database: true
2018-07-27 16:27:42.838 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-07-27 16:27:42.851 +03:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1532698062,
    "exp": 1532701662,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "mvc",
    "sub": "906123a3-4bab-49ae-a2c3-c0617fb03398",
    "auth_time": 1532698050,
    "idp": "local",
    "scope": [
      "openid",
      "profile",
      "api1",
      "offline_access"
    ],
    "amr": "pwd"
  }
}
2018-07-27 16:27:42.864 +03:00 [DBG] Creating userinfo response
2018-07-27 16:27:42.871 +03:00 [DBG] Scopes in access token: openid profile api1 offline_access
2018-07-27 16:27:42.877 +03:00 [DBG] Scopes in access token: openid profile api1 offline_access
2018-07-27 16:27:42.890 +03:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-07-27 16:27:42.894 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2018-07-27 16:27:42.897 +03:00 [DBG] Scopes in access token: openid profile api1 offline_access
2018-07-27 16:27:42.905 +03:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-07-27 16:27:42.917 +03:00 [INF] Profile service returned to the following claim types: sub name given_name family_name website preferred_username
2018-07-27 16:27:42.920 +03:00 [DBG] End userinfo request
2018-07-27 16:34:20.138 +03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-07-27 16:34:20.204 +03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-07-27 16:34:20.207 +03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-07-27 16:34:20.210 +03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-07-27 16:34:20.218 +03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-07-27 16:34:20.618 +03:00 [DBG] Starting token cleanup
2018-07-27 16:34:22.138 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-07-27 16:34:22.162 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-07-27 16:34:32.942 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-07-27 16:34:32.950 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-07-27 16:34:32.952 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-07-27 16:34:32.957 +03:00 [DBG] Start discovery request
2018-07-27 16:34:34.024 +03:00 [DBG] Found ["openid","profile","api1"] as all scopes in database
2018-07-27 16:34:34.351 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-07-27 16:34:34.353 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-07-27 16:34:34.355 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-07-27 16:34:34.361 +03:00 [DBG] Start key discovery request
2018-07-27 16:34:34.479 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-07-27 16:34:34.496 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-07-27 16:34:34.504 +03:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2018-07-27 16:34:34.510 +03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2018-07-27 16:34:34.514 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2018-07-27 16:34:34.530 +03:00 [DBG] Processing signout request for 906123a3-4bab-49ae-a2c3-c0617fb03398
2018-07-27 16:34:34.541 +03:00 [DBG] Start end session request validation
2018-07-27 16:34:34.550 +03:00 [DBG] Start identity token validation
2018-07-27 16:34:34.960 +03:00 [DBG] mvc found in database: true
2018-07-27 16:34:34.964 +03:00 [DBG] Client found: mvc / MVC Client
2018-07-27 16:34:35.129 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-07-27 16:34:35.142 +03:00 [DBG] Token validation success
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1532698062,
    "exp": 1532698362,
    "iss": "http://localhost:5000",
    "aud": "mvc",
    "nonce": "636682947955907681.NjUzYWRjN2YtNmJkZi00MzczLWE5ODAtZTM2MzI4MWU5NzExM2RlNzVhN2UtNjgyZS00NDNjLWFjNTQtZGQ1MDU5N2FiYTE3",
    "iat": 1532698062,
    "at_hash": "M5D2BHuytEzV6lbMqMMPUg",
    "sid": "ae318ad7ec95807cc0e9a5f3408b08ad",
    "sub": "906123a3-4bab-49ae-a2c3-c0617fb03398",
    "auth_time": 1532698050,
    "idp": "local",
    "amr": "pwd"
  }
}
2018-07-27 16:34:35.165 +03:00 [INF] End session request validation success
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "SubjectId": "906123a3-4bab-49ae-a2c3-c0617fb03398",
  "PostLogOutUri": "http://localhost:5002/signout-callback-oidc",
  "State": "CfDJ8KuqC1l7QeZCrHnUtlrKrzIAqeov1oZlF6yUInwzZ971IADbprsOBRuw3TsqOQAuyMk09t0DnQVJyqZmnl9bg6eSQ6qhhaq59-pHSPuVa8BkCfFC60e2E9ylHi3_6Ultw5XLwjNkmHXxQ9E4dKCtz_3y_A9_qnvLKZstGg8eSwMQ",
  "Raw": {
    "post_logout_redirect_uri": "http://localhost:5002/signout-callback-oidc",
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6ImY2NzZhNjNmM2QxZmRmYTNmMzgyZGNmZDNkYjNkZjc3IiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MzI2OTgwNjIsImV4cCI6MTUzMjY5ODM2MiwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoibXZjIiwibm9uY2UiOiI2MzY2ODI5NDc5NTU5MDc2ODEuTmpVellXUmpOMll0Tm1Ka1ppMDBNemN6TFdFNU9EQXRaVE0yTXpJNE1XVTVOekV4TTJSbE56VmhOMlV0TmpneVpTMDBORE5qTFdGak5UUXRaR1ExTURVNU4yRmlZVEUzIiwiaWF0IjoxNTMyNjk4MDYyLCJhdF9oYXNoIjoiTTVEMkJIdXl0RXpWNmxiTXFNTVBVZyIsInNpZCI6ImFlMzE4YWQ3ZWM5NTgwN2NjMGU5YTVmMzQwOGIwOGFkIiwic3ViIjoiOTA2MTIzYTMtNGJhYi00OWFlLWEyYzMtYzA2MTdmYjAzMzk4IiwiYXV0aF90aW1lIjoxNTMyNjk4MDUwLCJpZHAiOiJsb2NhbCIsImFtciI6WyJwd2QiXX0.RMOhTC7EnBRvlCM9aYz1lMf09dB015bwwYnas1ezdHdMCgpIPryizda1gXUwF1iBUW9AKRKNHkdz6QhTNgQK7HA0V0cM93UzOez2VgcHH-Iq-Zm-KYMcaPkRItJIF1LUjS23roDI7I276fcmwEA4w-O0hxMLtiyuTPk60UxrQNpo63ltBD6MiH1o5K-acq-LLShuT3JzVpOb6A1Ozxm70BTsiHE3kz_2MtOcXPtT5f-3baGklgj8qL0pc2GsWK9ET9_Smi8q_Bfipi4JpotCMEXKhzIvCWv7hxTO4Im9VH6XEQsSLhpT4zR7yK7CyFnMiETLnKAp8AQODrbNZ7bpmA",
    "state": "CfDJ8KuqC1l7QeZCrHnUtlrKrzIAqeov1oZlF6yUInwzZ971IADbprsOBRuw3TsqOQAuyMk09t0DnQVJyqZmnl9bg6eSQ6qhhaq59-pHSPuVa8BkCfFC60e2E9ylHi3_6Ultw5XLwjNkmHXxQ9E4dKCtz_3y_A9_qnvLKZstGg8eSwMQ",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-07-27 16:34:35.174 +03:00 [DBG] Success validating end session request from mvc
2018-07-27 16:34:35.210 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-07-27 16:34:35.219 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-07-27 16:34:35.351 +03:00 [INF] AuthenticationScheme: Identity.Application signed out.
2018-07-27 16:34:35.357 +03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-07-27 16:34:35.359 +03:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2018-07-27 16:34:35.405 +03:00 [INF] {
  "Name": "User Logout Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1002,
  "SubjectId": "906123a3-4bab-49ae-a2c3-c0617fb03398",
  "DisplayName": "Alice Smith",
  "ActivityId": "0HLFJOMKBG95I:00000003",
  "TimeStamp": "2018-07-27T13:34:35Z",
  "ProcessId": 19612,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-07-27 16:34:35.620 +03:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2018-07-27 16:34:35.629 +03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2018-07-27 16:34:35.636 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2018-07-27 16:34:35.648 +03:00 [DBG] Processing signout callback request
2018-07-27 16:34:35.701 +03:00 [DBG] mvc found in database: true
2018-07-27 16:34:35.703 +03:00 [DBG] No client front-channel logout URLs
2018-07-27 16:34:35.706 +03:00 [DBG] No client back-channel logout URLs
2018-07-27 16:34:35.708 +03:00 [INF] Successful signout callback.
2018-07-27 16:34:35.709 +03:00 [DBG] No client front-channel iframe urls
2018-07-27 16:34:35.713 +03:00 [DBG] No client back-channel iframe urls
2018-07-27 16:34:46.262 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-07-27 16:34:46.275 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-07-27 16:34:46.280 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-07-27 16:34:46.291 +03:00 [DBG] Start authorize request
2018-07-27 16:34:46.302 +03:00 [DBG] No user present in authorize request
2018-07-27 16:34:46.312 +03:00 [DBG] Start authorize request protocol validation
2018-07-27 16:34:46.366 +03:00 [DBG] mvc found in database: true
2018-07-27 16:34:46.374 +03:00 [DBG] Checking for PKCE parameters
2018-07-27 16:34:46.378 +03:00 [DBG] No PKCE used.
2018-07-27 16:34:46.423 +03:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-07-27 16:34:46.558 +03:00 [DBG] Found ["api1"] API scopes in database
2018-07-27 16:34:46.746 +03:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-07-27 16:34:46.776 +03:00 [DBG] Found ["api1"] API scopes in database
2018-07-27 16:34:46.810 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-07-27 16:34:46.840 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1 offline_access",
  "State": "CfDJ8KuqC1l7QeZCrHnUtlrKrzKGvSosDmQ5r_EkqaVppMiQEnfKlvyGI2XkrkMxyZfGL8yhux1ONpdMkygHwZsRJVDr3hgMx-lV4J44CiKRE57H6y8EbHRluDtNA8gLwPOq8jEo7IQ8-CQOmrbB-P1AARrLGWe3bwJEPjv232XcOAyVp5wgWadLaTL2ErTM5cpiB5S1dR8yB1Fx8N-Yx9EA1HU4q47ctin3R_spEa6VmT361G_QKAE2Ja0qn0NYY9wzozop8ZQVqgHBlzKVAVX5a7oSM11_LxGKnLZfudSCEAgS1CM7b3leTRuGXEiUrt3O5L_L4dU39_7Et8MJkzWqWow",
  "Nonce": "636682952862321614.YmZiNmM5NGMtMjM3MC00YTk1LWFjYzEtZDZhNzdjNWUxYmQ4MzM0Yjc4YTUtNTNmNC00M2FkLTgzOGYtZjYzYWM1YzhjYzdl",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636682952862321614.YmZiNmM5NGMtMjM3MC00YTk1LWFjYzEtZDZhNzdjNWUxYmQ4MzM0Yjc4YTUtNTNmNC00M2FkLTgzOGYtZjYzYWM1YzhjYzdl",
    "state": "CfDJ8KuqC1l7QeZCrHnUtlrKrzKGvSosDmQ5r_EkqaVppMiQEnfKlvyGI2XkrkMxyZfGL8yhux1ONpdMkygHwZsRJVDr3hgMx-lV4J44CiKRE57H6y8EbHRluDtNA8gLwPOq8jEo7IQ8-CQOmrbB-P1AARrLGWe3bwJEPjv232XcOAyVp5wgWadLaTL2ErTM5cpiB5S1dR8yB1Fx8N-Yx9EA1HU4q47ctin3R_spEa6VmT361G_QKAE2Ja0qn0NYY9wzozop8ZQVqgHBlzKVAVX5a7oSM11_LxGKnLZfudSCEAgS1CM7b3leTRuGXEiUrt3O5L_L4dU39_7Et8MJkzWqWow",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-07-27 16:34:46.860 +03:00 [INF] Showing login: User is not authenticated
2018-07-27 16:34:46.923 +03:00 [DBG] Start authorize request protocol validation
2018-07-27 16:34:46.949 +03:00 [DBG] mvc found in database: true
2018-07-27 16:34:46.954 +03:00 [DBG] Checking for PKCE parameters
2018-07-27 16:34:46.956 +03:00 [DBG] No PKCE used.
2018-07-27 16:34:46.965 +03:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-07-27 16:34:46.980 +03:00 [DBG] Found ["api1"] API scopes in database
2018-07-27 16:34:46.989 +03:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-07-27 16:34:47.004 +03:00 [DBG] Found ["api1"] API scopes in database
2018-07-27 16:34:47.008 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-07-27 16:34:47.035 +03:00 [DBG] mvc found in database: true
2018-07-27 16:34:52.155 +03:00 [INF] AuthenticationScheme: Google was challenged.
2018-07-27 16:49:16.484 +03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-07-27 16:49:16.572 +03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-07-27 16:49:16.609 +03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-07-27 16:49:16.658 +03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-07-27 16:49:16.711 +03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-07-27 16:49:17.366 +03:00 [DBG] Starting token cleanup
2018-07-27 16:49:19.284 +03:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2018-07-27 16:49:19.344 +03:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2018-07-30 19:09:32.758 +03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-07-30 19:09:32.850 +03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-07-30 19:09:32.869 +03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-07-30 19:09:32.881 +03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-07-30 19:09:32.886 +03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-07-30 19:09:33.427 +03:00 [DBG] Starting token cleanup
2018-07-30 19:09:35.322 +03:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2018-07-30 19:09:35.364 +03:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2018-07-30 19:10:36.510 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-07-30 19:10:36.537 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-07-30 19:10:36.539 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-07-30 19:10:36.544 +03:00 [DBG] Start discovery request
2018-07-30 19:10:37.646 +03:00 [DBG] Found ["openid","profile","api1"] as all scopes in database
2018-07-30 19:10:37.952 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-07-30 19:10:37.956 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-07-30 19:10:37.959 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-07-30 19:10:37.968 +03:00 [DBG] Start key discovery request
2018-07-30 19:10:38.120 +03:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2018-07-30 19:10:38.125 +03:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2018-07-30 19:10:38.128 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-07-30 19:10:38.140 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-07-30 19:10:38.142 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-07-30 19:10:38.150 +03:00 [DBG] Start authorize request
2018-07-30 19:10:38.158 +03:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2018-07-30 19:10:38.167 +03:00 [DBG] No user present in authorize request
2018-07-30 19:10:38.174 +03:00 [DBG] Start authorize request protocol validation
2018-07-30 19:10:38.617 +03:00 [DBG] mvc found in database: true
2018-07-30 19:10:38.627 +03:00 [DBG] Checking for PKCE parameters
2018-07-30 19:10:38.632 +03:00 [DBG] No PKCE used.
2018-07-30 19:10:38.690 +03:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-07-30 19:10:38.820 +03:00 [DBG] Found ["api1"] API scopes in database
2018-07-30 19:10:38.852 +03:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-07-30 19:10:38.952 +03:00 [DBG] Found ["api1"] API scopes in database
2018-07-30 19:10:38.966 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-07-30 19:10:38.987 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1 offline_access",
  "State": "CfDJ8KuqC1l7QeZCrHnUtlrKrzKv_ZfDosOrNja4QCCafcgsTBbFrcO2UiQQabrP54kXHIXdKXBxHQMYCctwK_Dm2AAuj2n9DSuq0sgSpa23kYlENsIlrMrOFWtnkWdYupMym59eSeJo5Y55jY0GNxFryUCIShDsDBm9Pc8rHl5t5PQAwIcFT0UEDDqRwsAdt9u-aROYTnioFIB7C4uya_mMVu026HRPUyiIniu-BYC9uNsKNW3Ap8DpnO_dbHAIQ3_Jgcyohs97ITONTlncnuB3D4lhoG3ixNcZ1bgPPaccVV5XrQehq0MTQFYdVCMfkn0P4zJjU4G6CTwBydNYF0aGppk",
  "Nonce": "636685638380921543.YzVjZjQwNmQtY2M4ZC00Y2M5LTk4M2ItYjZjMjJjZDY4MzA1MjZiNzhjYjYtYWU1NC00MTg4LWI4YTktYTM1OTIzZmRkYTRi",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636685638380921543.YzVjZjQwNmQtY2M4ZC00Y2M5LTk4M2ItYjZjMjJjZDY4MzA1MjZiNzhjYjYtYWU1NC00MTg4LWI4YTktYTM1OTIzZmRkYTRi",
    "state": "CfDJ8KuqC1l7QeZCrHnUtlrKrzKv_ZfDosOrNja4QCCafcgsTBbFrcO2UiQQabrP54kXHIXdKXBxHQMYCctwK_Dm2AAuj2n9DSuq0sgSpa23kYlENsIlrMrOFWtnkWdYupMym59eSeJo5Y55jY0GNxFryUCIShDsDBm9Pc8rHl5t5PQAwIcFT0UEDDqRwsAdt9u-aROYTnioFIB7C4uya_mMVu026HRPUyiIniu-BYC9uNsKNW3Ap8DpnO_dbHAIQ3_Jgcyohs97ITONTlncnuB3D4lhoG3ixNcZ1bgPPaccVV5XrQehq0MTQFYdVCMfkn0P4zJjU4G6CTwBydNYF0aGppk",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-07-30 19:10:39.020 +03:00 [INF] Showing login: User is not authenticated
2018-07-30 19:10:39.043 +03:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2018-07-30 19:10:39.050 +03:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2018-07-30 19:10:39.132 +03:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2018-07-30 19:10:39.137 +03:00 [DBG] Start authorize request protocol validation
2018-07-30 19:10:39.190 +03:00 [DBG] mvc found in database: true
2018-07-30 19:10:39.193 +03:00 [DBG] Checking for PKCE parameters
2018-07-30 19:10:39.195 +03:00 [DBG] No PKCE used.
2018-07-30 19:10:39.208 +03:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-07-30 19:10:39.327 +03:00 [DBG] Found ["api1"] API scopes in database
2018-07-30 19:10:39.365 +03:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-07-30 19:10:39.454 +03:00 [DBG] Found ["api1"] API scopes in database
2018-07-30 19:10:39.458 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-07-30 19:10:39.507 +03:00 [DBG] mvc found in database: true
2018-07-30 19:10:47.508 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-07-30 19:10:47.514 +03:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2018-07-30 19:10:47.521 +03:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2018-07-30 19:11:01.183 +03:00 [DBG] Augmenting SignInContext
2018-07-30 19:11:01.188 +03:00 [DBG] Adding idp claim with value: local
2018-07-30 19:11:01.190 +03:00 [DBG] Adding amr claim with value: pwd
2018-07-30 19:11:01.192 +03:00 [DBG] Adding auth_time claim with value: 1532967061
2018-07-30 19:11:01.197 +03:00 [INF] Identity.Application was not authenticated. Failure message: Unprotect ticket failed
2018-07-30 19:11:01.211 +03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-07-30 19:11:12.819 +03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "andrei_krasnou@epam.com",
  "SubjectId": "96e1b5f4-1f86-486d-b63d-a6e83f49ae90",
  "DisplayName": "andrei_krasnou@epam.com",
  "Endpoint": "UI",
  "ActivityId": "0HLFM6RBG8RN3:00000004",
  "TimeStamp": "2018-07-30T16:11:12Z",
  "ProcessId": 9652,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-07-30 19:11:32.445 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-07-30 19:11:32.453 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-07-30 19:11:32.457 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-07-30 19:11:32.461 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-07-30 19:11:32.466 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-07-30 19:11:32.476 +03:00 [DBG] Start authorize callback request
2018-07-30 19:11:32.487 +03:00 [DBG] User in authorize request: 96e1b5f4-1f86-486d-b63d-a6e83f49ae90
2018-07-30 19:11:32.490 +03:00 [DBG] Start authorize request protocol validation
2018-07-30 19:11:32.541 +03:00 [DBG] mvc found in database: true
2018-07-30 19:11:32.544 +03:00 [DBG] Checking for PKCE parameters
2018-07-30 19:11:32.546 +03:00 [DBG] No PKCE used.
2018-07-30 19:11:32.559 +03:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-07-30 19:11:32.646 +03:00 [DBG] Found ["api1"] API scopes in database
2018-07-30 19:11:32.659 +03:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-07-30 19:11:32.684 +03:00 [DBG] Found ["api1"] API scopes in database
2018-07-30 19:11:32.689 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-07-30 19:11:32.691 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "96e1b5f4-1f86-486d-b63d-a6e83f49ae90",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1 offline_access",
  "State": "CfDJ8KuqC1l7QeZCrHnUtlrKrzKv_ZfDosOrNja4QCCafcgsTBbFrcO2UiQQabrP54kXHIXdKXBxHQMYCctwK_Dm2AAuj2n9DSuq0sgSpa23kYlENsIlrMrOFWtnkWdYupMym59eSeJo5Y55jY0GNxFryUCIShDsDBm9Pc8rHl5t5PQAwIcFT0UEDDqRwsAdt9u-aROYTnioFIB7C4uya_mMVu026HRPUyiIniu-BYC9uNsKNW3Ap8DpnO_dbHAIQ3_Jgcyohs97ITONTlncnuB3D4lhoG3ixNcZ1bgPPaccVV5XrQehq0MTQFYdVCMfkn0P4zJjU4G6CTwBydNYF0aGppk",
  "Nonce": "636685638380921543.YzVjZjQwNmQtY2M4ZC00Y2M5LTk4M2ItYjZjMjJjZDY4MzA1MjZiNzhjYjYtYWU1NC00MTg4LWI4YTktYTM1OTIzZmRkYTRi",
  "SessionId": "8a0273d454da220a0a514efbec24feb0",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636685638380921543.YzVjZjQwNmQtY2M4ZC00Y2M5LTk4M2ItYjZjMjJjZDY4MzA1MjZiNzhjYjYtYWU1NC00MTg4LWI4YTktYTM1OTIzZmRkYTRi",
    "state": "CfDJ8KuqC1l7QeZCrHnUtlrKrzKv_ZfDosOrNja4QCCafcgsTBbFrcO2UiQQabrP54kXHIXdKXBxHQMYCctwK_Dm2AAuj2n9DSuq0sgSpa23kYlENsIlrMrOFWtnkWdYupMym59eSeJo5Y55jY0GNxFryUCIShDsDBm9Pc8rHl5t5PQAwIcFT0UEDDqRwsAdt9u-aROYTnioFIB7C4uya_mMVu026HRPUyiIniu-BYC9uNsKNW3Ap8DpnO_dbHAIQ3_Jgcyohs97ITONTlncnuB3D4lhoG3ixNcZ1bgPPaccVV5XrQehq0MTQFYdVCMfkn0P4zJjU4G6CTwBydNYF0aGppk",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-07-30 19:11:32.730 +03:00 [DBG] Scopes contains offline_access, consent is required
2018-07-30 19:11:32.732 +03:00 [INF] Showing consent: User has not yet consented
2018-07-30 19:11:32.753 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-07-30 19:11:32.759 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-07-30 19:11:32.791 +03:00 [DBG] Start authorize request protocol validation
2018-07-30 19:11:32.822 +03:00 [DBG] mvc found in database: true
2018-07-30 19:11:32.825 +03:00 [DBG] Checking for PKCE parameters
2018-07-30 19:11:32.827 +03:00 [DBG] No PKCE used.
2018-07-30 19:11:32.837 +03:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-07-30 19:11:32.856 +03:00 [DBG] Found ["api1"] API scopes in database
2018-07-30 19:11:32.869 +03:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-07-30 19:11:32.886 +03:00 [DBG] Found ["api1"] API scopes in database
2018-07-30 19:11:32.891 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-07-30 19:11:32.919 +03:00 [DBG] mvc found in database: true
2018-07-30 19:11:32.931 +03:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-07-30 19:11:33.004 +03:00 [DBG] Found ["api1"] API scopes in database
2018-07-30 19:13:07.472 +03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-07-30 19:13:07.553 +03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-07-30 19:13:07.573 +03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-07-30 19:13:07.586 +03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-07-30 19:13:07.592 +03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-07-30 19:13:08.017 +03:00 [DBG] Starting token cleanup
2018-07-30 19:13:09.622 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-07-30 19:13:09.680 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-07-30 19:14:02.489 +03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-07-30 19:14:02.565 +03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-07-30 19:14:02.569 +03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-07-30 19:14:02.573 +03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-07-30 19:14:02.578 +03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-07-30 19:14:02.977 +03:00 [DBG] Starting token cleanup
2018-07-30 19:14:03.510 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-07-30 19:14:03.537 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-07-30 19:14:36.627 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-07-30 19:14:36.639 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-07-30 19:14:36.641 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-07-30 19:14:36.646 +03:00 [DBG] Start discovery request
2018-07-30 19:14:37.759 +03:00 [DBG] Found ["openid","profile","api1"] as all scopes in database
2018-07-30 19:14:38.115 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-07-30 19:14:38.119 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-07-30 19:14:38.134 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-07-30 19:14:38.145 +03:00 [DBG] Start key discovery request
2018-07-30 19:14:38.256 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-07-30 19:14:38.263 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-07-30 19:14:38.268 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-07-30 19:14:38.280 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-07-30 19:14:38.284 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-07-30 19:14:38.297 +03:00 [DBG] Start authorize request
2018-07-30 19:14:38.312 +03:00 [DBG] User in authorize request: 96e1b5f4-1f86-486d-b63d-a6e83f49ae90
2018-07-30 19:14:38.326 +03:00 [DBG] Start authorize request protocol validation
2018-07-30 19:14:38.716 +03:00 [DBG] mvc found in database: true
2018-07-30 19:14:38.726 +03:00 [DBG] Checking for PKCE parameters
2018-07-30 19:14:38.730 +03:00 [DBG] No PKCE used.
2018-07-30 19:14:38.774 +03:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-07-30 19:14:38.883 +03:00 [DBG] Found ["api1"] API scopes in database
2018-07-30 19:14:38.908 +03:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-07-30 19:14:38.927 +03:00 [DBG] Found ["api1"] API scopes in database
2018-07-30 19:14:38.940 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-07-30 19:14:38.959 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "96e1b5f4-1f86-486d-b63d-a6e83f49ae90",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1 offline_access",
  "State": "CfDJ8KuqC1l7QeZCrHnUtlrKrzL5ln3RKPuk-MQ4WSWJ9WVpo0on2uX7nyZO2yRk_UwTvWY9kvvO1_ep1kiQ5RPMpyXZT5haXj8HwAbxLKAaH56x1RD-NmxJXoK7W9xQbDWtXVlPJrFoyV3ZAcBAAKiYKFOFCCYvyOAgdLFmrwsFE6S9RKbK3zdyiZ-B4N-Kd-EPU3OYNVVHbHSGnMBYuPdrL4J1e6ve_xTTBQEQxIHBacSICEkfKBDjZMrZmkObRLNJOkmZpsmSkKqZ8Ym7_3Uf5N_R0OpiYFvwyKCkPQPLtPyvlRXtJaSt0sYZmwKKfZK4_q0Cr1FqScUB2RtbIyuA8Lc",
  "Nonce": "636685640782344872.MGZiNjJjMjctMTIxMy00MDVkLWE2NzYtMzUwMzM5NWMyYzE4MjcxNzI4NTgtMDZjMC00OWZhLWE4NWYtMzM0NGJkYTZhMDZk",
  "SessionId": "8a0273d454da220a0a514efbec24feb0",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636685640782344872.MGZiNjJjMjctMTIxMy00MDVkLWE2NzYtMzUwMzM5NWMyYzE4MjcxNzI4NTgtMDZjMC00OWZhLWE4NWYtMzM0NGJkYTZhMDZk",
    "state": "CfDJ8KuqC1l7QeZCrHnUtlrKrzL5ln3RKPuk-MQ4WSWJ9WVpo0on2uX7nyZO2yRk_UwTvWY9kvvO1_ep1kiQ5RPMpyXZT5haXj8HwAbxLKAaH56x1RD-NmxJXoK7W9xQbDWtXVlPJrFoyV3ZAcBAAKiYKFOFCCYvyOAgdLFmrwsFE6S9RKbK3zdyiZ-B4N-Kd-EPU3OYNVVHbHSGnMBYuPdrL4J1e6ve_xTTBQEQxIHBacSICEkfKBDjZMrZmkObRLNJOkmZpsmSkKqZ8Ym7_3Uf5N_R0OpiYFvwyKCkPQPLtPyvlRXtJaSt0sYZmwKKfZK4_q0Cr1FqScUB2RtbIyuA8Lc",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-07-30 19:14:39.061 +03:00 [INF] Showing login: User is not active
2018-07-30 19:14:39.082 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-07-30 19:14:39.087 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-07-30 19:14:39.164 +03:00 [DBG] Start authorize request protocol validation
2018-07-30 19:14:39.244 +03:00 [DBG] mvc found in database: true
2018-07-30 19:14:39.247 +03:00 [DBG] Checking for PKCE parameters
2018-07-30 19:14:39.250 +03:00 [DBG] No PKCE used.
2018-07-30 19:14:39.263 +03:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-07-30 19:14:39.282 +03:00 [DBG] Found ["api1"] API scopes in database
2018-07-30 19:14:39.292 +03:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-07-30 19:14:39.310 +03:00 [DBG] Found ["api1"] API scopes in database
2018-07-30 19:14:39.313 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-07-30 19:14:39.346 +03:00 [DBG] mvc found in database: true
2018-07-30 19:14:55.262 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-07-30 19:14:55.267 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-07-30 19:14:55.270 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-07-30 19:15:07.793 +03:00 [WRN] User 249d64e3-44cf-4dff-b4b2-3e7ae960a432 cannot sign in without a confirmed email.
2018-07-30 19:15:15.918 +03:00 [INF] {
  "Name": "User Login Failure",
  "Category": "Authentication",
  "EventType": "Failure",
  "Id": 1001,
  "Username": "andrei_krasnou@epam.com",
  "Endpoint": "UI",
  "Message": "invalid credentials",
  "ActivityId": "0HLFM6TRL6DLE:00000004",
  "TimeStamp": "2018-07-30T16:15:15Z",
  "ProcessId": 28608,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-07-30 19:15:21.206 +03:00 [DBG] Start authorize request protocol validation
2018-07-30 19:15:21.260 +03:00 [DBG] mvc found in database: true
2018-07-30 19:15:21.264 +03:00 [DBG] Checking for PKCE parameters
2018-07-30 19:15:21.267 +03:00 [DBG] No PKCE used.
2018-07-30 19:15:21.279 +03:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-07-30 19:15:21.362 +03:00 [DBG] Found ["api1"] API scopes in database
2018-07-30 19:15:21.372 +03:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-07-30 19:15:21.388 +03:00 [DBG] Found ["api1"] API scopes in database
2018-07-30 19:15:21.393 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-07-30 19:15:21.428 +03:00 [DBG] mvc found in database: true
2018-07-30 19:16:11.160 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-07-30 19:16:11.171 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-07-30 19:16:11.175 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-07-30 19:16:15.137 +03:00 [DBG] Augmenting SignInContext
2018-07-30 19:16:15.141 +03:00 [DBG] Adding idp claim with value: local
2018-07-30 19:16:15.144 +03:00 [DBG] Adding amr claim with value: pwd
2018-07-30 19:16:15.147 +03:00 [DBG] Adding auth_time claim with value: 1532967375
2018-07-30 19:16:15.166 +03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-07-30 19:16:15.179 +03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "andrei_krasnou@epam.com",
  "SubjectId": "249d64e3-44cf-4dff-b4b2-3e7ae960a432",
  "DisplayName": "andrei_krasnou@epam.com",
  "Endpoint": "UI",
  "ActivityId": "0HLFM6TRL6DLE:00000005",
  "TimeStamp": "2018-07-30T16:16:15Z",
  "ProcessId": 28608,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-07-30 19:16:15.210 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-07-30 19:16:15.219 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-07-30 19:16:15.224 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-07-30 19:16:15.235 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-07-30 19:16:15.238 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-07-30 19:16:15.252 +03:00 [DBG] Start authorize callback request
2018-07-30 19:16:15.260 +03:00 [DBG] User in authorize request: 249d64e3-44cf-4dff-b4b2-3e7ae960a432
2018-07-30 19:16:15.262 +03:00 [DBG] Start authorize request protocol validation
2018-07-30 19:16:15.315 +03:00 [DBG] mvc found in database: true
2018-07-30 19:16:15.317 +03:00 [DBG] Checking for PKCE parameters
2018-07-30 19:16:15.319 +03:00 [DBG] No PKCE used.
2018-07-30 19:16:15.330 +03:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-07-30 19:16:15.404 +03:00 [DBG] Found ["api1"] API scopes in database
2018-07-30 19:16:15.411 +03:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-07-30 19:16:15.425 +03:00 [DBG] Found ["api1"] API scopes in database
2018-07-30 19:16:15.432 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-07-30 19:16:15.435 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "249d64e3-44cf-4dff-b4b2-3e7ae960a432",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1 offline_access",
  "State": "CfDJ8KuqC1l7QeZCrHnUtlrKrzL5ln3RKPuk-MQ4WSWJ9WVpo0on2uX7nyZO2yRk_UwTvWY9kvvO1_ep1kiQ5RPMpyXZT5haXj8HwAbxLKAaH56x1RD-NmxJXoK7W9xQbDWtXVlPJrFoyV3ZAcBAAKiYKFOFCCYvyOAgdLFmrwsFE6S9RKbK3zdyiZ-B4N-Kd-EPU3OYNVVHbHSGnMBYuPdrL4J1e6ve_xTTBQEQxIHBacSICEkfKBDjZMrZmkObRLNJOkmZpsmSkKqZ8Ym7_3Uf5N_R0OpiYFvwyKCkPQPLtPyvlRXtJaSt0sYZmwKKfZK4_q0Cr1FqScUB2RtbIyuA8Lc",
  "Nonce": "636685640782344872.MGZiNjJjMjctMTIxMy00MDVkLWE2NzYtMzUwMzM5NWMyYzE4MjcxNzI4NTgtMDZjMC00OWZhLWE4NWYtMzM0NGJkYTZhMDZk",
  "SessionId": "d20a7d0607a420e19f7fd8974cf1251b",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636685640782344872.MGZiNjJjMjctMTIxMy00MDVkLWE2NzYtMzUwMzM5NWMyYzE4MjcxNzI4NTgtMDZjMC00OWZhLWE4NWYtMzM0NGJkYTZhMDZk",
    "state": "CfDJ8KuqC1l7QeZCrHnUtlrKrzL5ln3RKPuk-MQ4WSWJ9WVpo0on2uX7nyZO2yRk_UwTvWY9kvvO1_ep1kiQ5RPMpyXZT5haXj8HwAbxLKAaH56x1RD-NmxJXoK7W9xQbDWtXVlPJrFoyV3ZAcBAAKiYKFOFCCYvyOAgdLFmrwsFE6S9RKbK3zdyiZ-B4N-Kd-EPU3OYNVVHbHSGnMBYuPdrL4J1e6ve_xTTBQEQxIHBacSICEkfKBDjZMrZmkObRLNJOkmZpsmSkKqZ8Ym7_3Uf5N_R0OpiYFvwyKCkPQPLtPyvlRXtJaSt0sYZmwKKfZK4_q0Cr1FqScUB2RtbIyuA8Lc",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-07-30 19:16:15.462 +03:00 [DBG] Scopes contains offline_access, consent is required
2018-07-30 19:16:15.465 +03:00 [INF] Showing consent: User has not yet consented
2018-07-30 19:16:15.485 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-07-30 19:16:15.490 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-07-30 19:16:15.516 +03:00 [DBG] Start authorize request protocol validation
2018-07-30 19:16:15.542 +03:00 [DBG] mvc found in database: true
2018-07-30 19:16:15.544 +03:00 [DBG] Checking for PKCE parameters
2018-07-30 19:16:15.546 +03:00 [DBG] No PKCE used.
2018-07-30 19:16:15.554 +03:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-07-30 19:16:15.569 +03:00 [DBG] Found ["api1"] API scopes in database
2018-07-30 19:16:15.576 +03:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-07-30 19:16:15.591 +03:00 [DBG] Found ["api1"] API scopes in database
2018-07-30 19:16:15.594 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-07-30 19:16:15.619 +03:00 [DBG] mvc found in database: true
2018-07-30 19:16:15.629 +03:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-07-30 19:16:15.706 +03:00 [DBG] Found ["api1"] API scopes in database
2018-07-30 19:16:24.874 +03:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-07-30 19:16:24.880 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-07-30 19:16:24.886 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-07-30 19:16:24.919 +03:00 [DBG] Start authorize request protocol validation
2018-07-30 19:16:24.947 +03:00 [DBG] mvc found in database: true
2018-07-30 19:16:24.949 +03:00 [DBG] Checking for PKCE parameters
2018-07-30 19:16:24.953 +03:00 [DBG] No PKCE used.
2018-07-30 19:16:24.960 +03:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-07-30 19:16:24.977 +03:00 [DBG] Found ["api1"] API scopes in database
2018-07-30 19:16:24.988 +03:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-07-30 19:16:25.006 +03:00 [DBG] Found ["api1"] API scopes in database
2018-07-30 19:16:25.009 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-07-30 19:16:25.042 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-07-30 19:16:25.048 +03:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2018-07-30 19:16:25.053 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-07-30 19:16:25.057 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-07-30 19:16:25.060 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-07-30 19:16:25.062 +03:00 [DBG] Start authorize callback request
2018-07-30 19:16:25.102 +03:00 [DBG] User in authorize request: 249d64e3-44cf-4dff-b4b2-3e7ae960a432
2018-07-30 19:16:25.106 +03:00 [DBG] Start authorize request protocol validation
2018-07-30 19:16:25.142 +03:00 [DBG] mvc found in database: true
2018-07-30 19:16:25.144 +03:00 [DBG] Checking for PKCE parameters
2018-07-30 19:16:25.147 +03:00 [DBG] No PKCE used.
2018-07-30 19:16:25.156 +03:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-07-30 19:16:25.172 +03:00 [DBG] Found ["api1"] API scopes in database
2018-07-30 19:16:25.181 +03:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-07-30 19:16:25.197 +03:00 [DBG] Found ["api1"] API scopes in database
2018-07-30 19:16:25.201 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-07-30 19:16:25.204 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "249d64e3-44cf-4dff-b4b2-3e7ae960a432",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1 offline_access",
  "State": "CfDJ8KuqC1l7QeZCrHnUtlrKrzL5ln3RKPuk-MQ4WSWJ9WVpo0on2uX7nyZO2yRk_UwTvWY9kvvO1_ep1kiQ5RPMpyXZT5haXj8HwAbxLKAaH56x1RD-NmxJXoK7W9xQbDWtXVlPJrFoyV3ZAcBAAKiYKFOFCCYvyOAgdLFmrwsFE6S9RKbK3zdyiZ-B4N-Kd-EPU3OYNVVHbHSGnMBYuPdrL4J1e6ve_xTTBQEQxIHBacSICEkfKBDjZMrZmkObRLNJOkmZpsmSkKqZ8Ym7_3Uf5N_R0OpiYFvwyKCkPQPLtPyvlRXtJaSt0sYZmwKKfZK4_q0Cr1FqScUB2RtbIyuA8Lc",
  "Nonce": "636685640782344872.MGZiNjJjMjctMTIxMy00MDVkLWE2NzYtMzUwMzM5NWMyYzE4MjcxNzI4NTgtMDZjMC00OWZhLWE4NWYtMzM0NGJkYTZhMDZk",
  "SessionId": "d20a7d0607a420e19f7fd8974cf1251b",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636685640782344872.MGZiNjJjMjctMTIxMy00MDVkLWE2NzYtMzUwMzM5NWMyYzE4MjcxNzI4NTgtMDZjMC00OWZhLWE4NWYtMzM0NGJkYTZhMDZk",
    "state": "CfDJ8KuqC1l7QeZCrHnUtlrKrzL5ln3RKPuk-MQ4WSWJ9WVpo0on2uX7nyZO2yRk_UwTvWY9kvvO1_ep1kiQ5RPMpyXZT5haXj8HwAbxLKAaH56x1RD-NmxJXoK7W9xQbDWtXVlPJrFoyV3ZAcBAAKiYKFOFCCYvyOAgdLFmrwsFE6S9RKbK3zdyiZ-B4N-Kd-EPU3OYNVVHbHSGnMBYuPdrL4J1e6ve_xTTBQEQxIHBacSICEkfKBDjZMrZmkObRLNJOkmZpsmSkKqZ8Ym7_3Uf5N_R0OpiYFvwyKCkPQPLtPyvlRXtJaSt0sYZmwKKfZK4_q0Cr1FqScUB2RtbIyuA8Lc",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-07-30 19:16:25.223 +03:00 [DBG] Scopes contains offline_access, consent is required
2018-07-30 19:16:25.233 +03:00 [INF] User consented to scopes: ["openid","profile","api1","offline_access"]
2018-07-30 19:16:25.241 +03:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","api1","offline_access"]
2018-07-30 19:16:25.258 +03:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: 249d64e3-44cf-4dff-b4b2-3e7ae960a432
2018-07-30 19:16:25.309 +03:00 [DBG] GUtLGrB4C8UJvHlDuRX8otgKY2Wk7gBZ2U/wFnR9dKA= not found in database
2018-07-30 19:16:25.399 +03:00 [DBG] Creating Hybrid Flow response.
2018-07-30 19:16:25.439 +03:00 [DBG] cEVZFyP3SDsjibpyHQJaRlEcoChF1upXn9fIX2hc6tk= not found in database
2018-07-30 19:16:25.454 +03:00 [DBG] Creating Implicit Flow response.
2018-07-30 19:16:25.471 +03:00 [DBG] Getting claims for identity token for subject: 249d64e3-44cf-4dff-b4b2-3e7ae960a432 and client: mvc
2018-07-30 19:16:25.476 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-07-30 19:16:25.560 +03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "Endpoint": "Authorize",
  "SubjectId": "249d64e3-44cf-4dff-b4b2-3e7ae960a432",
  "Scopes": "openid profile api1 offline_access",
  "GrantType": "hybrid",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****r1XA"
    },
    {
      "TokenType": "code",
      "TokenValue": "****39e3"
    }
  ],
  "ActivityId": "0HLFM6TRL6DLE:00000009",
  "TimeStamp": "2018-07-30T16:16:25Z",
  "ProcessId": 28608,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-07-30 19:16:25.570 +03:00 [INF] Authorize endpoint response
{
  "SubjectId": "249d64e3-44cf-4dff-b4b2-3e7ae960a432",
  "ClientId": "mvc",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "State": "CfDJ8KuqC1l7QeZCrHnUtlrKrzL5ln3RKPuk-MQ4WSWJ9WVpo0on2uX7nyZO2yRk_UwTvWY9kvvO1_ep1kiQ5RPMpyXZT5haXj8HwAbxLKAaH56x1RD-NmxJXoK7W9xQbDWtXVlPJrFoyV3ZAcBAAKiYKFOFCCYvyOAgdLFmrwsFE6S9RKbK3zdyiZ-B4N-Kd-EPU3OYNVVHbHSGnMBYuPdrL4J1e6ve_xTTBQEQxIHBacSICEkfKBDjZMrZmkObRLNJOkmZpsmSkKqZ8Ym7_3Uf5N_R0OpiYFvwyKCkPQPLtPyvlRXtJaSt0sYZmwKKfZK4_q0Cr1FqScUB2RtbIyuA8Lc",
  "Scope": "openid profile api1 offline_access"
}
2018-07-30 19:16:25.595 +03:00 [DBG] Augmenting SignInContext
2018-07-30 19:16:25.598 +03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-07-30 19:16:25.796 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2018-07-30 19:16:25.805 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2018-07-30 19:16:25.807 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2018-07-30 19:16:25.818 +03:00 [DBG] Start token request.
2018-07-30 19:16:25.826 +03:00 [DBG] Start client validation
2018-07-30 19:16:25.834 +03:00 [DBG] Start parsing Basic Authentication secret
2018-07-30 19:16:25.840 +03:00 [DBG] Start parsing for secret in post body
2018-07-30 19:16:25.842 +03:00 [DBG] Parser found secret: PostBodySecretParser
2018-07-30 19:16:25.844 +03:00 [DBG] Secret id found: mvc
2018-07-30 19:16:25.877 +03:00 [DBG] mvc found in database: true
2018-07-30 19:16:25.894 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2018-07-30 19:16:25.897 +03:00 [DBG] Client validation success
2018-07-30 19:16:25.906 +03:00 [INF] {
  "Name": "Client Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1010,
  "ClientId": "mvc",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HLFM6TRL6DLN:00000001",
  "TimeStamp": "2018-07-30T16:16:25Z",
  "ProcessId": 28608,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-07-30 19:16:25.918 +03:00 [DBG] Start token request validation
2018-07-30 19:16:25.933 +03:00 [DBG] Start validation of authorization code token request
2018-07-30 19:16:25.960 +03:00 [DBG] cEVZFyP3SDsjibpyHQJaRlEcoChF1upXn9fIX2hc6tk= found in database: true
2018-07-30 19:16:25.996 +03:00 [DBG] removing cEVZFyP3SDsjibpyHQJaRlEcoChF1upXn9fIX2hc6tk= persisted grant from database
2018-07-30 19:16:26.032 +03:00 [DBG] Validation of authorization code token request success
2018-07-30 19:16:26.050 +03:00 [INF] Token request validation success
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "GrantType": "authorization_code",
  "AuthorizationCode": "a64cd0107ee582c6a8795fa1c2ac5a2044e9e59bd8ec5a1db563b11d5fa839e3",
  "Raw": {
    "client_id": "mvc",
    "client_secret": "***REDACTED***",
    "code": "a64cd0107ee582c6a8795fa1c2ac5a2044e9e59bd8ec5a1db563b11d5fa839e3",
    "grant_type": "authorization_code",
    "redirect_uri": "http://localhost:5002/signin-oidc"
  }
}
2018-07-30 19:16:26.096 +03:00 [DBG] mvc found in database: true
2018-07-30 19:16:26.106 +03:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-07-30 19:16:26.127 +03:00 [DBG] Found ["api1"] API scopes in database
2018-07-30 19:16:26.144 +03:00 [DBG] Getting claims for access token for client: mvc
2018-07-30 19:16:26.148 +03:00 [DBG] Getting claims for access token for subject: 249d64e3-44cf-4dff-b4b2-3e7ae960a432
2018-07-30 19:16:26.174 +03:00 [DBG] Creating refresh token
2018-07-30 19:16:26.176 +03:00 [DBG] Setting an absolute lifetime: 2592000
2018-07-30 19:16:26.198 +03:00 [DBG] V97i9lpvLfFw7NyUaY9lE5KMGcPHbsYdaWbhx9c3AFU= not found in database
2018-07-30 19:16:26.232 +03:00 [DBG] mvc found in database: true
2018-07-30 19:16:26.240 +03:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-07-30 19:16:26.256 +03:00 [DBG] Found ["api1"] API scopes in database
2018-07-30 19:16:26.260 +03:00 [DBG] Getting claims for identity token for subject: 249d64e3-44cf-4dff-b4b2-3e7ae960a432 and client: mvc
2018-07-30 19:16:26.262 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-07-30 19:16:26.269 +03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "Endpoint": "Token",
  "Scopes": "openid profile api1 offline_access",
  "GrantType": "authorization_code",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****Sc5g"
    },
    {
      "TokenType": "refresh_token",
      "TokenValue": "****3663"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****MQCQ"
    }
  ],
  "ActivityId": "0HLFM6TRL6DLN:00000001",
  "TimeStamp": "2018-07-30T16:16:26Z",
  "ProcessId": 28608,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-07-30 19:16:26.274 +03:00 [DBG] Token request success.
2018-07-30 19:16:26.298 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2018-07-30 19:16:26.305 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2018-07-30 19:16:26.307 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2018-07-30 19:16:26.321 +03:00 [DBG] Start userinfo request
2018-07-30 19:16:26.330 +03:00 [DBG] Bearer token found in header
2018-07-30 19:16:26.426 +03:00 [DBG] mvc found in database: true
2018-07-30 19:16:26.458 +03:00 [DBG] mvc found in database: true
2018-07-30 19:16:26.468 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-07-30 19:16:26.476 +03:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1532967386,
    "exp": 1532970986,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "mvc",
    "sub": "249d64e3-44cf-4dff-b4b2-3e7ae960a432",
    "auth_time": 1532967375,
    "idp": "local",
    "scope": [
      "openid",
      "profile",
      "api1",
      "offline_access"
    ],
    "amr": "pwd"
  }
}
2018-07-30 19:16:26.489 +03:00 [DBG] Creating userinfo response
2018-07-30 19:16:26.495 +03:00 [DBG] Scopes in access token: openid profile api1 offline_access
2018-07-30 19:16:26.503 +03:00 [DBG] Scopes in access token: openid profile api1 offline_access
2018-07-30 19:16:26.514 +03:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-07-30 19:16:26.518 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2018-07-30 19:16:26.520 +03:00 [DBG] Scopes in access token: openid profile api1 offline_access
2018-07-30 19:16:26.528 +03:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-07-30 19:16:26.541 +03:00 [INF] Profile service returned to the following claim types: sub preferred_username name
2018-07-30 19:16:26.544 +03:00 [DBG] End userinfo request
2018-07-31 11:04:02.238 +03:00 [FTL] Application startup exception
System.InvalidOperationException: Scheme already exists: Identity.Application
   at Microsoft.AspNetCore.Authentication.AuthenticationOptions.AddScheme(String name, Action`1 configureBuilder)
   at Microsoft.Extensions.Options.OptionsFactory`1.Create(String name)
   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)
   at System.Lazy`1.ExecutionAndPublication(LazyHelper executionAndPublication, Boolean useDefaultConstructor)
   at System.Lazy`1.CreateValue()
   at Microsoft.AspNetCore.Authentication.AuthenticationSchemeProvider..ctor(IOptions`1 options, IDictionary`2 schemes)
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitConstructor(ConstructorCallSite constructorCallSite, ServiceProviderEngineScope scope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitScoped(ScopedCallSite scopedCallSite, ServiceProviderEngineScope scope)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)
   at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)
   at Microsoft.AspNetCore.Builder.IdentityServerApplicationBuilderExtensions.<ValidateAsync>d__2.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Builder.IdentityServerApplicationBuilderExtensions.Validate(IApplicationBuilder app) in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Configuration\IdentityServerApplicationBuilderExtensions.cs:line 73
   at Microsoft.AspNetCore.Builder.IdentityServerApplicationBuilderExtensions.UseIdentityServer(IApplicationBuilder app) in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Configuration\IdentityServerApplicationBuilderExtensions.cs:line 29
   at IdentityServer.Startup.Configure(IApplicationBuilder app, IHostingEnvironment env) in D:\AuthPoc\IdentityServer\Startup.cs:line 132
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Microsoft.AspNetCore.Hosting.ConventionBasedStartup.Configure(IApplicationBuilder app)
   at Microsoft.AspNetCore.ApplicationInsights.HostingStartup.ApplicationInsightsLoggerStartupFilter.<>c__DisplayClass0_0.<Configure>b__0(IApplicationBuilder builder)
   at Microsoft.ApplicationInsights.AspNetCore.ApplicationInsightsStartupFilter.<>c__DisplayClass0_0.<Configure>b__0(IApplicationBuilder app)
   at Microsoft.AspNetCore.Hosting.Internal.AutoRequestServicesStartupFilter.<>c__DisplayClass0_0.<Configure>b__0(IApplicationBuilder builder)
   at Microsoft.AspNetCore.Hosting.Internal.WebHost.BuildApplication()
2018-07-31 11:07:45.461 +03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-07-31 11:07:45.573 +03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-07-31 11:07:45.610 +03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-07-31 11:07:45.634 +03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-07-31 11:07:45.642 +03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-07-31 11:07:46.042 +03:00 [DBG] Starting token cleanup
2018-07-31 11:08:58.996 +03:00 [DBG] Using Identity.Application as default scheme for authentication
2018-07-31 11:08:59.060 +03:00 [DBG] Using Identity.External as default scheme for sign-in
2018-07-31 11:08:59.066 +03:00 [DBG] Using Identity.External as default scheme for sign-out
2018-07-31 11:08:59.069 +03:00 [DBG] Using Identity.Application as default scheme for challenge
2018-07-31 11:08:59.073 +03:00 [DBG] Using Identity.Application as default scheme for forbid
2018-07-31 11:08:59.427 +03:00 [DBG] Starting token cleanup
2018-07-31 11:09:04.109 +03:00 [INF] AuthenticationScheme: Identity.Application signed out.
2018-07-31 11:09:04.119 +03:00 [INF] AuthenticationScheme: Identity.External signed out.
2018-07-31 11:09:04.122 +03:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2018-07-31 11:09:04.129 +03:00 [INF] Identity.Application was not authenticated. Failure message: No principal.
2018-07-31 11:09:04.147 +03:00 [INF] Identity.Application was not authenticated. Failure message: No principal.
2018-07-31 11:09:13.495 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-07-31 11:09:13.505 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-07-31 11:09:13.508 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-07-31 11:09:13.514 +03:00 [DBG] Start discovery request
2018-07-31 11:09:14.415 +03:00 [DBG] Found ["openid","profile","api1"] as all scopes in database
2018-07-31 11:09:19.798 +03:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-07-31 11:09:19.803 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-07-31 11:09:19.806 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-07-31 11:09:19.809 +03:00 [DBG] Start discovery request
2018-07-31 11:09:19.838 +03:00 [DBG] Found ["openid","profile","api1"] as all scopes in database
2018-07-31 11:09:20.072 +03:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-07-31 11:09:20.076 +03:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-07-31 11:09:20.078 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-07-31 11:09:20.085 +03:00 [DBG] Start key discovery request
2018-07-31 11:09:20.189 +03:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2018-07-31 11:09:20.199 +03:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2018-07-31 11:09:20.205 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2018-07-31 11:09:20.224 +03:00 [DBG] Processing signout request for anonymous
2018-07-31 11:09:20.232 +03:00 [DBG] Start end session request validation
2018-07-31 11:09:20.242 +03:00 [DBG] Start identity token validation
2018-07-31 11:09:20.708 +03:00 [DBG] mvc found in database: true
2018-07-31 11:09:20.712 +03:00 [DBG] Client found: mvc / MVC Client
2018-07-31 11:09:20.783 +03:00 [ERR] User marked as not active: 249d64e3-44cf-4dff-b4b2-3e7ae960a432
2018-07-31 11:09:20.796 +03:00 [INF] End session request validation failure: Error validating id token hint
{
  "SubjectId": "unknown",
  "Raw": {
    "post_logout_redirect_uri": "http://localhost:5002/signout-callback-oidc",
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6ImY2NzZhNjNmM2QxZmRmYTNmMzgyZGNmZDNkYjNkZjc3IiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MzI5NjczODYsImV4cCI6MTUzMjk2NzY4NiwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoibXZjIiwibm9uY2UiOiI2MzY2ODU2NDA3ODIzNDQ4NzIuTUdaaU5qSmpNamN0TVRJeE15MDBNRFZrTFdFMk56WXRNelV3TXpNNU5XTXlZekU0TWpjeE56STROVGd0TURaak1DMDBPV1poTFdFNE5XWXRNek0wTkdKa1lUWmhNRFprIiwiaWF0IjoxNTMyOTY3Mzg2LCJhdF9oYXNoIjoia3hDWUNPRS1hYkdZdjFITXdUMXhvdyIsInNpZCI6ImQyMGE3ZDA2MDdhNDIwZTE5ZjdmZDg5NzRjZjEyNTFiIiwic3ViIjoiMjQ5ZDY0ZTMtNDRjZi00ZGZmLWI0YjItM2U3YWU5NjBhNDMyIiwiYXV0aF90aW1lIjoxNTMyOTY3Mzc1LCJpZHAiOiJsb2NhbCIsImFtciI6WyJwd2QiXX0.a-gmP8Yl9dNMfQWSFekzZW1oeadgu4YlLY6VeYWL2IR7yQksbnrL3dI-RZzMEtAN51drwILfUXv_GJ72T1prpCwygxm3kai73QG7ehr_M-VxuJnXn7tZyvU3IiKWAMHAEfjgO44iq0mg5H4_367z0Q6Es1DBU1kahzD11NG3pi8jyENF9po7Cjpfqdsga4hscQ3qG845QFtTFCEaWbMf9ghizWnTL3H0M2kEioj5KbPiQ8gNm-IYuXI1A21DagU9J_8gMAFkERHr5ConlVEEASDwjgFQuEsm1aBS82t_bDHnP89jEQYE8HPzXP3j9YXC9YPg82GIYLXf8Mx00sSc5g",
    "state": "CfDJ8KuqC1l7QeZCrHnUtlrKrzIq_ltwtui_Bn5DsxPlZrRS2au8eK5qskgf-G1MSxfyNL5p_GfCAgJhlMZYG7yBEeDxbb49Gs99dGJu6DgsHtFLEEx4-nu57FBDBYyf-qVoxNbwpGmjHyea6-NrKmEJ0cv9jESdmmRRRDgBGapAhg1B",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-07-31 11:09:20.802 +03:00 [ERR] Error processing end session request Invalid request
2018-07-31 11:13:01.704 +03:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2018-07-31 11:13:01.713 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2018-07-31 11:13:01.716 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2018-07-31 11:13:01.727 +03:00 [DBG] Start authorize request
2018-07-31 11:13:01.734 +03:00 [DBG] No user present in authorize request
2018-07-31 11:13:01.743 +03:00 [DBG] Start authorize request protocol validation
2018-07-31 11:13:01.796 +03:00 [DBG] mvc found in database: true
2018-07-31 11:13:01.804 +03:00 [DBG] Checking for PKCE parameters
2018-07-31 11:13:01.808 +03:00 [DBG] No PKCE used.
2018-07-31 11:13:01.865 +03:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-07-31 11:13:01.992 +03:00 [DBG] Found ["api1"] API scopes in database
2018-07-31 11:13:02.014 +03:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-07-31 11:13:02.030 +03:00 [DBG] Found ["api1"] API scopes in database
2018-07-31 11:13:02.042 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-07-31 11:13:02.056 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1 offline_access",
  "State": "CfDJ8KuqC1l7QeZCrHnUtlrKrzICtF1dtmUwyJqoyckyAsVPGXCdGgtGI58_cD4qPOVLRq3BNj5Y9MQ_WOqZBhMzrcBcpiJJYnjOOl7FslzApMfOSQ-xO9yIl1CijvmmGMLT34tHuLe9hB6FgqrbOuECXmtwZUf-uYtIcuic-3TalXZejpfRnfFN8jjDiafqp4EPydUarxmWXX4KyVgg4Fy1yzQ9m573pFAO9G9G5j-gQZeTWZmvx-PSV-e1rpcj34FbL5GzSVU8KYntnVq7PLsUcYBJMRI8798FDPLJRxuqJOLxVR2_sA2SxVZMHxOvMqHEobyK-1SMpoI-3E0rltV5sRk",
  "Nonce": "636686215816836419.OWVlMzNhNjEtYWFkMS00OWY4LWI5NDctOTRiZDczMGZmMDY4ZmIwZTQ1OTgtYjFmMC00ZjIxLTk3MzQtZWViYmE3MTllNDYy",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636686215816836419.OWVlMzNhNjEtYWFkMS00OWY4LWI5NDctOTRiZDczMGZmMDY4ZmIwZTQ1OTgtYjFmMC00ZjIxLTk3MzQtZWViYmE3MTllNDYy",
    "state": "CfDJ8KuqC1l7QeZCrHnUtlrKrzICtF1dtmUwyJqoyckyAsVPGXCdGgtGI58_cD4qPOVLRq3BNj5Y9MQ_WOqZBhMzrcBcpiJJYnjOOl7FslzApMfOSQ-xO9yIl1CijvmmGMLT34tHuLe9hB6FgqrbOuECXmtwZUf-uYtIcuic-3TalXZejpfRnfFN8jjDiafqp4EPydUarxmWXX4KyVgg4Fy1yzQ9m573pFAO9G9G5j-gQZeTWZmvx-PSV-e1rpcj34FbL5GzSVU8KYntnVq7PLsUcYBJMRI8798FDPLJRxuqJOLxVR2_sA2SxVZMHxOvMqHEobyK-1SMpoI-3E0rltV5sRk",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-07-31 11:13:02.074 +03:00 [INF] Showing login: User is not authenticated
2018-07-31 11:13:02.139 +03:00 [DBG] Start authorize request protocol validation
2018-07-31 11:13:02.165 +03:00 [DBG] mvc found in database: true
2018-07-31 11:13:02.168 +03:00 [DBG] Checking for PKCE parameters
2018-07-31 11:13:02.171 +03:00 [DBG] No PKCE used.
2018-07-31 11:13:02.179 +03:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-07-31 11:13:02.194 +03:00 [DBG] Found ["api1"] API scopes in database
2018-07-31 11:13:02.201 +03:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-07-31 11:13:02.215 +03:00 [DBG] Found ["api1"] API scopes in database
2018-07-31 11:13:02.217 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-07-31 11:13:02.245 +03:00 [DBG] mvc found in database: true
2018-07-31 11:13:09.911 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-07-31 11:13:14.130 +03:00 [WRN] Invalid password for user ddb5688a-19ff-4d46-8199-645663391740.
2018-07-31 11:13:14.135 +03:00 [WRN] User ddb5688a-19ff-4d46-8199-645663391740 failed to provide the correct password.
2018-07-31 11:13:14.613 +03:00 [INF] {
  "Name": "User Login Failure",
  "Category": "Authentication",
  "EventType": "Failure",
  "Id": 1001,
  "Username": "andrei_krasnou@epam.com",
  "Endpoint": "UI",
  "Message": "invalid credentials",
  "ActivityId": "0HLFMNJFGA09H:00000008",
  "TimeStamp": "2018-07-31T08:13:14Z",
  "ProcessId": 36088,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-07-31 11:13:14.619 +03:00 [DBG] Start authorize request protocol validation
2018-07-31 11:13:14.652 +03:00 [DBG] mvc found in database: true
2018-07-31 11:13:14.654 +03:00 [DBG] Checking for PKCE parameters
2018-07-31 11:13:14.657 +03:00 [DBG] No PKCE used.
2018-07-31 11:13:14.670 +03:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-07-31 11:13:14.687 +03:00 [DBG] Found ["api1"] API scopes in database
2018-07-31 11:13:14.699 +03:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-07-31 11:13:14.717 +03:00 [DBG] Found ["api1"] API scopes in database
2018-07-31 11:13:14.721 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-07-31 11:13:14.757 +03:00 [DBG] mvc found in database: true
2018-07-31 11:13:44.664 +03:00 [DBG] CORS request made for path: /account/login from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-07-31 11:13:48.144 +03:00 [DBG] Augmenting SignInContext
2018-07-31 11:13:48.153 +03:00 [DBG] Adding idp claim with value: local
2018-07-31 11:13:48.155 +03:00 [DBG] Adding amr claim with value: pwd
2018-07-31 11:13:48.158 +03:00 [DBG] Adding auth_time claim with value: 1533024828
2018-07-31 11:13:48.190 +03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-07-31 11:13:50.429 +03:00 [INF] {
  "Name": "User Login Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1000,
  "Username": "andrei_krasnou@epam.com",
  "SubjectId": "ddb5688a-19ff-4d46-8199-645663391740",
  "DisplayName": "andrei_krasnou@epam.com",
  "Endpoint": "UI",
  "ActivityId": "0HLFMNJFGA09H:00000009",
  "TimeStamp": "2018-07-31T08:13:50Z",
  "ProcessId": 36088,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-07-31 11:13:50.469 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-07-31 11:13:50.480 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-07-31 11:13:50.488 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-07-31 11:13:50.504 +03:00 [DBG] Start authorize callback request
2018-07-31 11:13:50.512 +03:00 [DBG] User in authorize request: ddb5688a-19ff-4d46-8199-645663391740
2018-07-31 11:13:50.514 +03:00 [DBG] Start authorize request protocol validation
2018-07-31 11:13:50.561 +03:00 [DBG] mvc found in database: true
2018-07-31 11:13:50.563 +03:00 [DBG] Checking for PKCE parameters
2018-07-31 11:13:50.567 +03:00 [DBG] No PKCE used.
2018-07-31 11:13:50.578 +03:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-07-31 11:13:50.664 +03:00 [DBG] Found ["api1"] API scopes in database
2018-07-31 11:13:50.675 +03:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-07-31 11:13:50.691 +03:00 [DBG] Found ["api1"] API scopes in database
2018-07-31 11:13:50.695 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-07-31 11:13:50.697 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "ddb5688a-19ff-4d46-8199-645663391740",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1 offline_access",
  "State": "CfDJ8KuqC1l7QeZCrHnUtlrKrzICtF1dtmUwyJqoyckyAsVPGXCdGgtGI58_cD4qPOVLRq3BNj5Y9MQ_WOqZBhMzrcBcpiJJYnjOOl7FslzApMfOSQ-xO9yIl1CijvmmGMLT34tHuLe9hB6FgqrbOuECXmtwZUf-uYtIcuic-3TalXZejpfRnfFN8jjDiafqp4EPydUarxmWXX4KyVgg4Fy1yzQ9m573pFAO9G9G5j-gQZeTWZmvx-PSV-e1rpcj34FbL5GzSVU8KYntnVq7PLsUcYBJMRI8798FDPLJRxuqJOLxVR2_sA2SxVZMHxOvMqHEobyK-1SMpoI-3E0rltV5sRk",
  "Nonce": "636686215816836419.OWVlMzNhNjEtYWFkMS00OWY4LWI5NDctOTRiZDczMGZmMDY4ZmIwZTQ1OTgtYjFmMC00ZjIxLTk3MzQtZWViYmE3MTllNDYy",
  "SessionId": "0a3c8a487198d8493883734cbab573d1",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636686215816836419.OWVlMzNhNjEtYWFkMS00OWY4LWI5NDctOTRiZDczMGZmMDY4ZmIwZTQ1OTgtYjFmMC00ZjIxLTk3MzQtZWViYmE3MTllNDYy",
    "state": "CfDJ8KuqC1l7QeZCrHnUtlrKrzICtF1dtmUwyJqoyckyAsVPGXCdGgtGI58_cD4qPOVLRq3BNj5Y9MQ_WOqZBhMzrcBcpiJJYnjOOl7FslzApMfOSQ-xO9yIl1CijvmmGMLT34tHuLe9hB6FgqrbOuECXmtwZUf-uYtIcuic-3TalXZejpfRnfFN8jjDiafqp4EPydUarxmWXX4KyVgg4Fy1yzQ9m573pFAO9G9G5j-gQZeTWZmvx-PSV-e1rpcj34FbL5GzSVU8KYntnVq7PLsUcYBJMRI8798FDPLJRxuqJOLxVR2_sA2SxVZMHxOvMqHEobyK-1SMpoI-3E0rltV5sRk",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-07-31 11:13:50.734 +03:00 [DBG] Scopes contains offline_access, consent is required
2018-07-31 11:13:50.736 +03:00 [INF] Showing consent: User has not yet consented
2018-07-31 11:13:50.774 +03:00 [DBG] Start authorize request protocol validation
2018-07-31 11:13:50.800 +03:00 [DBG] mvc found in database: true
2018-07-31 11:13:50.803 +03:00 [DBG] Checking for PKCE parameters
2018-07-31 11:13:50.806 +03:00 [DBG] No PKCE used.
2018-07-31 11:13:50.815 +03:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-07-31 11:13:50.831 +03:00 [DBG] Found ["api1"] API scopes in database
2018-07-31 11:13:50.840 +03:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-07-31 11:13:50.857 +03:00 [DBG] Found ["api1"] API scopes in database
2018-07-31 11:13:50.859 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-07-31 11:13:50.885 +03:00 [DBG] mvc found in database: true
2018-07-31 11:13:50.895 +03:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-07-31 11:13:50.965 +03:00 [DBG] Found ["api1"] API scopes in database
2018-07-31 11:13:52.980 +03:00 [DBG] CORS request made for path: /consent from origin: null but was ignored because path was not for an allowed IdentityServer CORS endpoint
2018-07-31 11:13:53.026 +03:00 [DBG] Start authorize request protocol validation
2018-07-31 11:13:53.056 +03:00 [DBG] mvc found in database: true
2018-07-31 11:13:53.058 +03:00 [DBG] Checking for PKCE parameters
2018-07-31 11:13:53.061 +03:00 [DBG] No PKCE used.
2018-07-31 11:13:53.068 +03:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-07-31 11:13:53.084 +03:00 [DBG] Found ["api1"] API scopes in database
2018-07-31 11:13:53.092 +03:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-07-31 11:13:53.107 +03:00 [DBG] Found ["api1"] API scopes in database
2018-07-31 11:13:53.112 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-07-31 11:13:53.143 +03:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2018-07-31 11:13:53.148 +03:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2018-07-31 11:13:53.153 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2018-07-31 11:13:53.158 +03:00 [DBG] Start authorize callback request
2018-07-31 11:13:53.193 +03:00 [DBG] User in authorize request: ddb5688a-19ff-4d46-8199-645663391740
2018-07-31 11:13:53.198 +03:00 [DBG] Start authorize request protocol validation
2018-07-31 11:13:53.237 +03:00 [DBG] mvc found in database: true
2018-07-31 11:13:53.239 +03:00 [DBG] Checking for PKCE parameters
2018-07-31 11:13:53.241 +03:00 [DBG] No PKCE used.
2018-07-31 11:13:53.249 +03:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-07-31 11:13:53.265 +03:00 [DBG] Found ["api1"] API scopes in database
2018-07-31 11:13:53.275 +03:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-07-31 11:13:53.292 +03:00 [DBG] Found ["api1"] API scopes in database
2018-07-31 11:13:53.295 +03:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2018-07-31 11:13:53.299 +03:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "ddb5688a-19ff-4d46-8199-645663391740",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile api1 offline_access",
  "State": "CfDJ8KuqC1l7QeZCrHnUtlrKrzICtF1dtmUwyJqoyckyAsVPGXCdGgtGI58_cD4qPOVLRq3BNj5Y9MQ_WOqZBhMzrcBcpiJJYnjOOl7FslzApMfOSQ-xO9yIl1CijvmmGMLT34tHuLe9hB6FgqrbOuECXmtwZUf-uYtIcuic-3TalXZejpfRnfFN8jjDiafqp4EPydUarxmWXX4KyVgg4Fy1yzQ9m573pFAO9G9G5j-gQZeTWZmvx-PSV-e1rpcj34FbL5GzSVU8KYntnVq7PLsUcYBJMRI8798FDPLJRxuqJOLxVR2_sA2SxVZMHxOvMqHEobyK-1SMpoI-3E0rltV5sRk",
  "Nonce": "636686215816836419.OWVlMzNhNjEtYWFkMS00OWY4LWI5NDctOTRiZDczMGZmMDY4ZmIwZTQ1OTgtYjFmMC00ZjIxLTk3MzQtZWViYmE3MTllNDYy",
  "SessionId": "0a3c8a487198d8493883734cbab573d1",
  "Raw": {
    "client_id": "mvc",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636686215816836419.OWVlMzNhNjEtYWFkMS00OWY4LWI5NDctOTRiZDczMGZmMDY4ZmIwZTQ1OTgtYjFmMC00ZjIxLTk3MzQtZWViYmE3MTllNDYy",
    "state": "CfDJ8KuqC1l7QeZCrHnUtlrKrzICtF1dtmUwyJqoyckyAsVPGXCdGgtGI58_cD4qPOVLRq3BNj5Y9MQ_WOqZBhMzrcBcpiJJYnjOOl7FslzApMfOSQ-xO9yIl1CijvmmGMLT34tHuLe9hB6FgqrbOuECXmtwZUf-uYtIcuic-3TalXZejpfRnfFN8jjDiafqp4EPydUarxmWXX4KyVgg4Fy1yzQ9m573pFAO9G9G5j-gQZeTWZmvx-PSV-e1rpcj34FbL5GzSVU8KYntnVq7PLsUcYBJMRI8798FDPLJRxuqJOLxVR2_sA2SxVZMHxOvMqHEobyK-1SMpoI-3E0rltV5sRk",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2018-07-31 11:13:53.319 +03:00 [DBG] Scopes contains offline_access, consent is required
2018-07-31 11:13:53.328 +03:00 [INF] User consented to scopes: ["openid","profile","api1","offline_access"]
2018-07-31 11:13:53.332 +03:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","api1","offline_access"]
2018-07-31 11:13:53.339 +03:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: ddb5688a-19ff-4d46-8199-645663391740
2018-07-31 11:13:53.387 +03:00 [DBG] WtG9i/4bGVHKYfwYW85p4Xd6lWfEOG9rFJ978iI5pvs= not found in database
2018-07-31 11:13:53.476 +03:00 [DBG] Creating Hybrid Flow response.
2018-07-31 11:13:53.506 +03:00 [DBG] ws1VYviqQrXryKDjw/d/qZLXS3IpooUJqjOF8ewfnKk= not found in database
2018-07-31 11:13:53.519 +03:00 [DBG] Creating Implicit Flow response.
2018-07-31 11:13:53.531 +03:00 [DBG] Getting claims for identity token for subject: ddb5688a-19ff-4d46-8199-645663391740 and client: mvc
2018-07-31 11:13:53.537 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-07-31 11:13:53.587 +03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "Endpoint": "Authorize",
  "SubjectId": "ddb5688a-19ff-4d46-8199-645663391740",
  "Scopes": "openid profile api1 offline_access",
  "GrantType": "hybrid",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****Y66w"
    },
    {
      "TokenType": "code",
      "TokenValue": "****d410"
    }
  ],
  "ActivityId": "0HLFMNJFGA09H:0000000D",
  "TimeStamp": "2018-07-31T08:13:53Z",
  "ProcessId": 36088,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-07-31 11:13:53.597 +03:00 [INF] Authorize endpoint response
{
  "SubjectId": "ddb5688a-19ff-4d46-8199-645663391740",
  "ClientId": "mvc",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "State": "CfDJ8KuqC1l7QeZCrHnUtlrKrzICtF1dtmUwyJqoyckyAsVPGXCdGgtGI58_cD4qPOVLRq3BNj5Y9MQ_WOqZBhMzrcBcpiJJYnjOOl7FslzApMfOSQ-xO9yIl1CijvmmGMLT34tHuLe9hB6FgqrbOuECXmtwZUf-uYtIcuic-3TalXZejpfRnfFN8jjDiafqp4EPydUarxmWXX4KyVgg4Fy1yzQ9m573pFAO9G9G5j-gQZeTWZmvx-PSV-e1rpcj34FbL5GzSVU8KYntnVq7PLsUcYBJMRI8798FDPLJRxuqJOLxVR2_sA2SxVZMHxOvMqHEobyK-1SMpoI-3E0rltV5sRk",
  "Scope": "openid profile api1 offline_access"
}
2018-07-31 11:13:53.622 +03:00 [DBG] Augmenting SignInContext
2018-07-31 11:13:53.625 +03:00 [INF] AuthenticationScheme: Identity.Application signed in.
2018-07-31 11:13:53.783 +03:00 [DBG] Request path /connect/token matched to endpoint type Token
2018-07-31 11:13:53.792 +03:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2018-07-31 11:13:53.795 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2018-07-31 11:13:53.807 +03:00 [DBG] Start token request.
2018-07-31 11:13:53.816 +03:00 [DBG] Start client validation
2018-07-31 11:13:53.825 +03:00 [DBG] Start parsing Basic Authentication secret
2018-07-31 11:13:53.832 +03:00 [DBG] Start parsing for secret in post body
2018-07-31 11:13:53.836 +03:00 [DBG] Parser found secret: PostBodySecretParser
2018-07-31 11:13:53.839 +03:00 [DBG] Secret id found: mvc
2018-07-31 11:13:53.874 +03:00 [DBG] mvc found in database: true
2018-07-31 11:13:53.887 +03:00 [DBG] Secret validator success: HashedSharedSecretValidator
2018-07-31 11:13:53.890 +03:00 [DBG] Client validation success
2018-07-31 11:13:53.897 +03:00 [INF] {
  "Name": "Client Authentication Success",
  "Category": "Authentication",
  "EventType": "Success",
  "Id": 1010,
  "ClientId": "mvc",
  "AuthenticationMethod": "SharedSecret",
  "ActivityId": "0HLFMNJFGA09O:00000001",
  "TimeStamp": "2018-07-31T08:13:53Z",
  "ProcessId": 36088,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-07-31 11:13:53.906 +03:00 [DBG] Start token request validation
2018-07-31 11:13:53.919 +03:00 [DBG] Start validation of authorization code token request
2018-07-31 11:13:53.948 +03:00 [DBG] ws1VYviqQrXryKDjw/d/qZLXS3IpooUJqjOF8ewfnKk= found in database: true
2018-07-31 11:13:53.988 +03:00 [DBG] removing ws1VYviqQrXryKDjw/d/qZLXS3IpooUJqjOF8ewfnKk= persisted grant from database
2018-07-31 11:13:54.016 +03:00 [DBG] Validation of authorization code token request success
2018-07-31 11:13:54.027 +03:00 [INF] Token request validation success
{
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "GrantType": "authorization_code",
  "AuthorizationCode": "c28fd54b5c5437506b2bbc5631eb2137984d22e97bcd6ecf1515b0abf1e8d410",
  "Raw": {
    "client_id": "mvc",
    "client_secret": "***REDACTED***",
    "code": "c28fd54b5c5437506b2bbc5631eb2137984d22e97bcd6ecf1515b0abf1e8d410",
    "grant_type": "authorization_code",
    "redirect_uri": "http://localhost:5002/signin-oidc"
  }
}
2018-07-31 11:13:54.067 +03:00 [DBG] mvc found in database: true
2018-07-31 11:13:54.079 +03:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-07-31 11:13:54.095 +03:00 [DBG] Found ["api1"] API scopes in database
2018-07-31 11:13:54.111 +03:00 [DBG] Getting claims for access token for client: mvc
2018-07-31 11:13:54.115 +03:00 [DBG] Getting claims for access token for subject: ddb5688a-19ff-4d46-8199-645663391740
2018-07-31 11:13:54.153 +03:00 [DBG] Creating refresh token
2018-07-31 11:13:54.156 +03:00 [DBG] Setting an absolute lifetime: 2592000
2018-07-31 11:13:54.183 +03:00 [DBG] O1IGBASIqMRAaV3L9lrrxwLLB8N9NgMeFZMw1hWmKII= not found in database
2018-07-31 11:13:54.217 +03:00 [DBG] mvc found in database: true
2018-07-31 11:13:54.225 +03:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-07-31 11:13:54.241 +03:00 [DBG] Found ["api1"] API scopes in database
2018-07-31 11:13:54.245 +03:00 [DBG] Getting claims for identity token for subject: ddb5688a-19ff-4d46-8199-645663391740 and client: mvc
2018-07-31 11:13:54.247 +03:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2018-07-31 11:13:54.254 +03:00 [INF] {
  "Name": "Token Issued Success",
  "Category": "Token",
  "EventType": "Success",
  "Id": 2000,
  "ClientId": "mvc",
  "ClientName": "MVC Client",
  "Endpoint": "Token",
  "Scopes": "openid profile api1 offline_access",
  "GrantType": "authorization_code",
  "Tokens": [
    {
      "TokenType": "id_token",
      "TokenValue": "****HgVQ"
    },
    {
      "TokenType": "refresh_token",
      "TokenValue": "****9cbc"
    },
    {
      "TokenType": "access_token",
      "TokenValue": "****Fqxw"
    }
  ],
  "ActivityId": "0HLFMNJFGA09O:00000001",
  "TimeStamp": "2018-07-31T08:13:54Z",
  "ProcessId": 36088,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-07-31 11:13:54.260 +03:00 [DBG] Token request success.
2018-07-31 11:13:54.280 +03:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2018-07-31 11:13:54.286 +03:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2018-07-31 11:13:54.289 +03:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2018-07-31 11:13:54.300 +03:00 [DBG] Start userinfo request
2018-07-31 11:13:54.307 +03:00 [DBG] Bearer token found in header
2018-07-31 11:13:54.350 +03:00 [DBG] mvc found in database: true
2018-07-31 11:13:54.377 +03:00 [DBG] mvc found in database: true
2018-07-31 11:13:54.389 +03:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2018-07-31 11:13:54.397 +03:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1533024834,
    "exp": 1533028434,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "mvc",
    "sub": "ddb5688a-19ff-4d46-8199-645663391740",
    "auth_time": 1533024828,
    "idp": "local",
    "scope": [
      "openid",
      "profile",
      "api1",
      "offline_access"
    ],
    "amr": "pwd"
  }
}
2018-07-31 11:13:54.415 +03:00 [DBG] Creating userinfo response
2018-07-31 11:13:54.422 +03:00 [DBG] Scopes in access token: openid profile api1 offline_access
2018-07-31 11:13:54.427 +03:00 [DBG] Scopes in access token: openid profile api1 offline_access
2018-07-31 11:13:54.439 +03:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-07-31 11:13:54.443 +03:00 [DBG] Requested claim types: sub name family_name given_name middle_name nickname preferred_username profile picture website gender birthdate zoneinfo locale updated_at
2018-07-31 11:13:54.445 +03:00 [DBG] Scopes in access token: openid profile api1 offline_access
2018-07-31 11:13:54.454 +03:00 [DBG] Found ["openid","profile"] identity scopes in database
2018-07-31 11:13:54.469 +03:00 [INF] Profile service returned to the following claim types: sub preferred_username name
2018-07-31 11:13:54.474 +03:00 [DBG] End userinfo request
